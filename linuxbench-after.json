{"id":"1","text":"Initial Setup","tests":[{"section":"1.1","desc":"Filesystem Configuration","Constraints":null,"type":"","results":[{"test_number":"1.1.1","test_desc":"Disable unused filesystems","SubChecks":null,"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"There are no test items"},{"test_number":"1.1.1.1.a","test_desc":"Ensure mounting of cramfs filesystems is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v cramfs","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/cramfs.conf\nand add the following line:\ninstall cramfs /bin/true\nRun the following command to unload the cramfs module:\n# rmmod cramfs\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/fs/cramfs/cramfs.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.1.1.b","test_desc":"Ensure mounting of cramfs filesystems is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep cramfs","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/cramfs.conf\nand add the following line:\ninstall cramfs /bin/true\nRun the following command to unload the cramfs module:\n# rmmod cramfs\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.1.2.a","test_desc":"Ensure mounting of freevxfs filesystems is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v freevxfs","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/freevxfs.conf\nand add the following line:\ninstall freevxfs /bin/true\nRun the following command to unload the freevxfs module:\n# rmmod freevxfs\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/fs/freevxfs/freevxfs.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.1.2.b","test_desc":"Ensure mounting of freevxfs filesystems is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep freevxfs","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/freevxfs.conf\nand add the following line:\ninstall freevxfs /bin/true\nRun the following command to unload the freevxfs module:\n# rmmod freevxfs\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.1.3.a","test_desc":"Ensure mounting of jffs2 filesystems is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v jffs2","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/jffs2.conf\nand add the following line:\ninstall jffs2 /bin/true\nRun the following command to unload the jffs2 module:\n# rmmod jffs2\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/drivers/mtd/mtd.ko.xz \ninsmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/fs/jffs2/jffs2.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.1.3.b","test_desc":"Ensure mounting of jffs2 filesystems is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep jffs2","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/jffs2.conf\nand add the following line:\ninstall jffs2 /bin/true\nRun the following command to unload the jffs2 module:\n# rmmod jffs2\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.1.4.a","test_desc":"Ensure mounting of hfs filesystems is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v hfs","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/hfs.conf\nand add the following line:\ninstall hfs /bin/true\nRun the following command to unload the hfs module:\n# rmmod hfs\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/fs/hfs/hfs.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.1.4.b","test_desc":"Ensure mounting of hfs filesystems is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep hfs","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/hfs.conf\nand add the following line:\ninstall hfs /bin/true\nRun the following command to unload the hfs module:\n# rmmod hfs\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.1.5.a","test_desc":"Ensure mounting of hfsplus filesystems is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v hfsplus","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/hfsplus.conf\nand add the following line:\ninstall hfsplus /bin/true\nRun the following command to unload the hfsplus module:\n# rmmod hfsplus\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/fs/hfsplus/hfsplus.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.1.5.b","test_desc":"Ensure mounting of hfsplus filesystems is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep hfsplus","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/hfsplus.conf\nand add the following line:\ninstall hfsplus /bin/true\nRun the following command to unload the hfsplus module:\n# rmmod hfsplus\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.1.6.a","test_desc":"Ensure mounting of squashfs filesystems is disabled","SubChecks":[{"audit_type":"","audit":"modprobe -n -v squashfs","type":"","Constraints":{"platform":["rhel7"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.1.1.6.b","test_desc":"Ensure mounting of squashfs filesystems is disabled","SubChecks":[{"audit_type":"","audit":"lsmod | grep squashfs","type":"","Constraints":{"platform":["rhel7"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.1.1.7.a","test_desc":"Ensure mounting of udf filesystems is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v udf","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/udf.conf\nand add the following line: install udf /bin/true\nRun the following command to unload the udf module:\n# rmmod udf\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/lib/crc-itu-t.ko.xz \ninsmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/fs/udf/udf.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.1.7.b","test_desc":"Ensure mounting of udf filesystems is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep udf","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/udf.conf\nand add the following line: install udf /bin/true\nRun the following command to unload the udf module:\n# rmmod udf\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.1.8.a","test_desc":"Ensure mounting of FAT filesystems is disabled","SubChecks":[{"audit_type":"","audit":"grep -i vfat /etc/fstab","type":"manual","Constraints":{"platform":["rhel7"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.1.1.8.b","test_desc":"Ensure mounting of FAT filesystems is disabled","SubChecks":[{"audit_type":"","audit":"modprobe -n -v vfat","type":"","Constraints":{"platform":["rhel7"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.1.1.8.c","test_desc":"Ensure mounting of FAT filesystems is disabled","SubChecks":[{"audit_type":"","audit":"lsmod | grep vfat","type":"","Constraints":{"platform":["rhel7"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.1.2.a","test_desc":"Ensure /tmp is configured","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/tmp\\s'","type":"","test_info":["Configure /etc/fstab as appropriate.\nexample:\ntmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\nOR\nRun the following commands to enable systemd /tmp mounting:\nsystemctl unmask tmp.mount systemctl enable tmp.mount\nEdit /etc/systemd/system/local-fs.target.wants/tmp.mount to configure the /tmp mount:\n[Mount]\nWhat=tmpfs\nWhere=/tmp\nType=tmpfs\nOptions=mode=1777,strictatime,noexec,nodev,nosuid\n"],"status":"FAIL","actual_value":"","expected_result":"'' Is not present","scored":true,"IsMultiple":false},{"test_number":"1.1.2.b","test_desc":"Ensure /tmp is configured","SubChecks":null,"audit_type":"","audit":"grep -E '\\s/tmp\\s' /etc/fstab | grep -E -v '^\\s*#'","type":"","test_info":["Configure /etc/fstab as appropriate.\nexample:\ntmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\nOR\nRun the following commands to enable systemd /tmp mounting:\nsystemctl unmask tmp.mount systemctl enable tmp.mount\nEdit /etc/systemd/system/local-fs.target.wants/tmp.mount to configure the /tmp mount:\n[Mount]\nWhat=tmpfs\nWhere=/tmp\nType=tmpfs\nOptions=mode=1777,strictatime,noexec,nodev,nosuid\n"],"status":"FAIL","actual_value":"","expected_result":"'' Is not present","scored":true,"IsMultiple":false},{"test_number":"1.1.3","test_desc":"Ensure nodev option set on /tmp partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/tmp\\s' | grep -v nodev","type":"","test_info":["Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition.\nSee the fstab(5) manual page for more information.\nRun the following command to remount /tmp :\n# mount -o remount,nodev /tmp\nor\nEdit /etc/systemd/system/local-fs.target.wants/tmp.mount to add nodev to the /tmp mount options:\n[Mount]\nOptions=mode=1777,strictatime,noexec,nodev,nosuid\nun the following command to remount /tmp :\n# mount -o remount,nodev /tmp\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.4","test_desc":"Ensure nosuid option set on /tmp partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/tmp\\s' | grep -v nosuid","type":"","test_info":["Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp\npartition. See the fstab(5) manual page for more information.\nRun the following command to remount /tmp :\n# mount -o remount,nosuid /tmp\nor\nEdit /etc/systemd/system/local-fs.target.wants/tmp.mount to add nosuid to the /tmp mount options:\n[Mount]\nOptions=mode=1777,strictatime,noexec,nodev,nosuid\nRun the following command to remount /tmp :\n# mount -o remount,nosuid /tmp\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.5","test_desc":"Ensure noexec option set on /tmp partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/tmp\\s' | grep -v noexec","type":"","test_info":["Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting options) for the `/tmp` partition. See the `fstab(5)` manual page for more information.\n            Run the following command to remount `/tmp` :\n\n# mount -o remount,noexec /tmp\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.6","test_desc":"Ensure separate partition exists for /var","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/var\\s'","type":"","test_info":["For new installations, during installation create a custom partition setup and specify a separate partition for `/var` .\nFor systems that were previously installed, create a new partition and configure `/etc/fstab` as appropriate.\n"],"status":"FAIL","actual_value":"","expected_result":"'/dev/xvdg1 on /var type ext4 (rw,relatime,data=ordered)' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.7","test_desc":"Ensure separate partition exists for /var/tmp","SubChecks":null,"audit_type":"","audit":"mount | grep /var/tmp","type":"","test_info":["For new installations, during installation create a custom partition setup and specify a separate partition for `/var/tmp` .\nFor systems that were previously installed, create a new partition and configure `/etc/fstab` as appropriate.\n"],"status":"FAIL","actual_value":"","expected_result":"' on /var/tmp type ext4 (rw,nosuid,nodev,noexec,relatime)' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.8","test_desc":"Ensure nodev option set on /var/tmp partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/var/tmp\\s' | grep -v nodev","type":"","test_info":["Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the\n/var/tmp partition. See the fstab(5) manual page for more information.\nRun the following command to remount /var/tmp :\n# mount -o remount,nodev /var/tmp\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.9","test_desc":"Ensure nosuid option set on /var/tmp partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/var/tmp\\s' | grep -v nosuid","type":"","test_info":["Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the\n/var/tmp partition. See the fstab(5) manual page for more information.\nRun the following command to remount /var/tmp :\n# mount -o remount,nosuid /var/tmp\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.10","test_desc":"Ensure noexec option set on /var/tmp partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/var/tmp\\s' | grep -v noexec","type":"","test_info":["Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the\n/var/tmp partition. See the fstab(5) manual page for more information.\nRun the following command to remount /var/tmp :\n# mount -o remount,noexec /var/tmp\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.11","test_desc":"Ensure separate partition exists for /var/log","SubChecks":null,"audit_type":"","audit":"mount | grep /var/log","type":"","test_info":["For new installations, during installation create a custom partition setup and specify a separate partition for `/var/log` .\nFor systems that were previously installed, create a new partition and configure `/etc/fstab` as appropriate.\n"],"status":"FAIL","actual_value":"","expected_result":"'/dev/xvdh1 on /var/log type ext4 (rw,relatime,data=ordered)' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.12","test_desc":"Ensure separate partition exists for /var/log/audit","SubChecks":null,"audit_type":"","audit":"mount | grep /var/log/audit","type":"","test_info":["For new installations, during installation create a custom partition setup and specify a separate partition for `/var/log/audit` .\nFor systems that were previously installed, create a new partition and configure `/etc/fstab` as appropriate.\n"],"status":"FAIL","actual_value":"","expected_result":"'/dev/xvdi1 on /var/log/audit type ext4 (rw,relatime,data=ordered)' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.13","test_desc":"Ensure separate partition exists for /home","SubChecks":null,"audit_type":"","audit":"mount | grep /home","type":"","test_info":["For new installations, during installation create a custom partition setup and specify a separate partition for `/home` .\nFor systems that were previously installed, create a new partition and configure `/etc/fstab` as appropriate.\n"],"status":"FAIL","actual_value":"","expected_result":"'/dev/xvdf1 on /home type ext4 (rw,nodev,relatime,data=ordered)' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.14","test_desc":"Ensure nodev option set on /home partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/home\\s' | grep -v nodev","type":"","test_info":["Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting options) for the `/home`\npartition. See the `fstab(5)` manual page for more information.\n\n# mount -o remount,nodev /home\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.15","test_desc":"Ensure nodev option set on /dev/shm partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/dev/shm\\s' | grep -v nodev","type":"","test_info":["Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting options) for the `/dev/shm` partition.\nSee the `fstab(5)` manual page for more information.\nRun the following command to remount `/dev/shm` :\n\n# mount -o remount,nodev /dev/shm\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.16","test_desc":"Ensure nosuid option set on /dev/shm partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/dev/shm\\s' | grep -v nosuid","type":"","test_info":["Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting options) for the `/dev/shm` partition.\nSee the `fstab(5)` manual page for more information.\nRun the following command to remount `/dev/shm` :\n\n# mount -o remount,nosuid /dev/shm\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.17","test_desc":"Ensure noexec option set on /dev/shm partition","SubChecks":null,"audit_type":"","audit":"mount | grep -E '\\s/dev/shm\\s' | grep -v noexec","type":"","test_info":["Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting options) for the `/dev/shm` partition.\nSee the `fstab(5)` manual page for more information.\nRun the following command to remount `/dev/shm` :\n\n# mount -o remount,noexec /dev/shm\n"],"status":"FAIL","actual_value":"tmpfs on /dev/shm type tmpfs (rw,nosuid,nodev,size=3972508k)\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"1.1.18","test_desc":"Ensure nodev option set on removable media partitions","SubChecks":null,"audit_type":"","audit":"mount","type":"manual","test_info":["Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the `fstab(5)` manual page for more information.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"1.1.19","test_desc":"Ensure nosuid option set on removable media partitions","SubChecks":null,"audit_type":"","audit":"mount","type":"manual","test_info":["Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the `fstab(5)` manual page for more information.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"1.1.20","test_desc":"Ensure noexec option set on removable media partitions","SubChecks":null,"audit_type":"","audit":"mount","type":"manual","test_info":["Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the `fstab(5)` manual page for more information.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"1.1.21","test_desc":"Ensure sticky bit is set on all world-writable directories","SubChecks":null,"audit_type":"","audit":"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2\u003e/dev/null | head -n 100","type":"","test_info":["Run the following command to set the sticky bit on all world writable directories:\n# df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2\u003e/dev/null | xargs -I '{}' chmod a+t '{}'\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"1.1.22","test_desc":"Disable Automounting","SubChecks":[{"audit_type":"","audit":"chkconfig --list autofs","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled autofs","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep autofs","type":"","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.1.23.a","test_desc":"Disable USB Storage","SubChecks":null,"audit_type":"","audit":"modprobe -n -v usb-storage","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/usb-storage.conf\nand add the following line:\ninstall usb-storage /bin/true\nRun the following command to unload the usb-storage module:\n# rmmod usb-storage\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/drivers/usb/storage/usb-storage.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"1.1.23.b","test_desc":"Disable USB Storage","SubChecks":null,"audit_type":"","audit":"lsmod | grep usb-storage","type":"","test_info":["Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\nExample: vim /etc/modprobe.d/usb-storage.conf\nand add the following line:\ninstall usb-storage /bin/true\nRun the following command to unload the usb-storage module:\n# rmmod usb-storage\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false}],"pass":17,"fail":15,"warn":10,"info":0},{"section":"1.2","desc":"Configure Software Updates","Constraints":null,"type":"","results":[{"test_number":"1.2.1","test_desc":"Ensure package manager repositories are configured","SubChecks":[{"audit_type":"","audit":"yum repo-list","type":"manual","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"apt-cache policy","type":"manual","Constraints":{"platform":["ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"zypper repos","type":"manual","Constraints":{"platform":["opensuse"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.2.2","test_desc":"Ensure GPG keys are configured","SubChecks":[{"audit_type":"","audit":"rpm -q gpg-pubkey --qf '%{name}-%{version}-%{release} --\u003e %{summary}'","type":"manual","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"apt-key list","type":"manual","Constraints":{"platform":["ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"zypper repos","type":"manual","Constraints":{"platform":["opensuse"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":0,"fail":0,"warn":2,"info":0},{"section":"1.3","desc":"Filesystem Integrity Checking","Constraints":null,"type":"","results":[{"test_number":"1.3.1","test_desc":"Ensure AIDE is installed","SubChecks":[{"audit_type":"","audit":"rpm -q aide","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s aide","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show aide","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.3.2.a","test_desc":"Ensure filesystem integrity is regularly checked","SubChecks":null,"audit_type":"","audit":"crontab -u root -l | grep aide","type":"","test_info":["Run the following commands: \n# cp ./config/aidecheck.service /etc/systemd/system/aidecheck.service \n# cp ./config/aidecheck.timer /etc/systemd/system/aidecheck.timer \n# chmod 0644 /etc/systemd/system/aidecheck.* \n\n# systemctl reenable aidecheck.timer \n# systemctl restart aidecheck.timer \n# systemctl daemon-reload\n\nor Run the following command:\n# crontab -u root -e\nAdd the following line to the crontab:\n0 5 * * * /usr/sbin/aide --check\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: crontab: command not found\n","expected_result":"'aide --check' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: crontab: command not found\n"},{"test_number":"1.3.2.b","test_desc":"Ensure filesystem integrity is regularly checked","SubChecks":null,"audit_type":"","audit":"grep -r aide /etc/cron.* /etc/crontab","type":"","test_info":["Run the following commands: \n# cp ./config/aidecheck.service /etc/systemd/system/aidecheck.service \n# cp ./config/aidecheck.timer /etc/systemd/system/aidecheck.timer \n# chmod 0644 /etc/systemd/system/aidecheck.* \n\n# systemctl reenable aidecheck.timer \n# systemctl restart aidecheck.timer \n# systemctl daemon-reload\n\nor Run the following command:\n# crontab -u root -e\nAdd the following line to the crontab:\n0 5 * * * /usr/sbin/aide --check\n"],"status":"FAIL","actual_value":"grep: /etc/cron.*: No such file or directory\ngrep: /etc/crontab: No such file or directory\n","expected_result":"'aide --check' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/cron.*: No such file or directory\ngrep: /etc/crontab: No such file or directory\n"}],"pass":0,"fail":2,"warn":1,"info":0},{"section":"1.4","desc":"Secure Boot Settings","Constraints":null,"type":"","results":[{"test_number":"1.4.1","test_desc":"Ensure permissions on bootloader config are configured","SubChecks":[{"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /boot/grub/menu.lst","type":"","Constraints":{"boot":["grub"]}},{"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/default/grub","type":"","Constraints":{"boot":["grub2"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"FAIL","actual_value":"stat: cannot statx '/boot/grub/menu.lst': Permission denied\n","expected_result":"'400/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/boot/grub/menu.lst': Permission denied\n"},{"test_number":"1.4.2","test_desc":"Ensure bootloader password is set","SubChecks":[{"audit_type":"","audit":"grep \"^\\s*password\" /boot/grub/menu.lst","type":"","Constraints":{"boot":["grub"]}},{"audit_type":"","audit":"grep \"^\\s*GRUB2_PASSWORD\" /boot/grub2/user.cfg","type":"","Constraints":{"boot":["grub2"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"FAIL","actual_value":"grep: /boot/grub/menu.lst: Permission denied\n","expected_result":"'password --md5 ' Is present","scored":true,"IsMultiple":false,"reason":"grep: /boot/grub/menu.lst: Permission denied\n"},{"test_number":"1.4.3","test_desc":"Ensure authentication required for single user mode","SubChecks":null,"audit_type":"","audit":"grep ^root:[*\\!]: /etc/shadow","type":"","test_info":["Consult your documentation and configure single user mode to require a password for login as appropriate.\n"],"status":"FAIL","actual_value":"grep: /etc/shadow: Permission denied\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: /etc/shadow: Permission denied\n"},{"test_number":"1.4.4","test_desc":"Ensure interactive boot is not enabled","SubChecks":[{"audit_type":"","audit":"grep \"^PROMPT_FOR_CONFIRM=\" /etc/sysconfig/boot","type":"","Constraints":{"boot":["grub"],"platform":["rhel7"]}},{"audit_type":"","audit":"grep PROMPT /etc/sysconfig/init","type":"","Constraints":{"boot":["grub2"],"platform":["rhel7"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":0,"fail":3,"warn":1,"info":0},{"section":"1.5","desc":"Additional Process Hardening","Constraints":null,"type":"","results":[{"test_number":"1.5.1.a","test_desc":"Ensure core dumps are restricted","SubChecks":null,"audit_type":"","audit":"grep \"hard\\s*core\" /etc/security/limits.conf /etc/security/limits.d/*","type":"","test_info":["Add the following line to `/etc/security/limits.conf` or a `/etc/security/limits.d/*` file:\n\n* hard core 0\n\nSet the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nfs.suid_dumpable = 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\nIf systemd-coredump is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\nStorage=none\nProcessSizeMax=0\nRun the command:\nsystemctl daemon-reload\n"],"status":"FAIL","actual_value":"grep: /etc/security/limits.conf: No such file or directory\ngrep: /etc/security/limits.d/*: No such file or directory\n","expected_result":"'hard' Is present AND 'core' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/security/limits.conf: No such file or directory\ngrep: /etc/security/limits.d/*: No such file or directory\n"},{"test_number":"1.5.1.b","test_desc":"Ensure core dumps are restricted","SubChecks":null,"audit_type":"","audit":"sysctl fs.suid_dumpable","type":"","test_info":["Add the following line to `/etc/security/limits.conf` or a `/etc/security/limits.d/*` file:\n\n* hard core 0\n\nSet the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nfs.suid_dumpable = 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\nIf systemd-coredump is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\nStorage=none\nProcessSizeMax=0\nRun the command:\nsystemctl daemon-reload\n"],"status":"FAIL","actual_value":"fs.suid_dumpable = 2\n","expected_result":"'fs.suid_dumpable' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"1.5.1.c","test_desc":"Ensure core dumps are restricted","SubChecks":null,"audit_type":"","audit":"grep \"fs\\.suid_dumpable\" /etc/sysctl.conf /etc/sysctl.d/* | head -n 1","type":"","test_info":["Add the following line to `/etc/security/limits.conf` or a `/etc/security/limits.d/*` file:\n\n* hard core 0\n\nSet the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nfs.suid_dumpable = 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\nIf systemd-coredump is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\nStorage=none\nProcessSizeMax=0\nRun the command:\nsystemctl daemon-reload\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/50-coredump.conf:fs.suid_dumpable=2\n","expected_result":"'fs.suid_dumpable' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"1.5.1.d","test_desc":"Ensure core dumps are restricted","SubChecks":null,"audit_type":"","audit":"systemctl is-enabled coredump.service","type":"","test_info":["Add the following line to `/etc/security/limits.conf` or a `/etc/security/limits.d/*` file:\n\n* hard core 0\n\nSet the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nfs.suid_dumpable = 0\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w fs.suid_dumpable=0\nIf systemd-coredump is installed:\nedit /etc/systemd/coredump.conf and add/modify the following lines:\nStorage=none\nProcessSizeMax=0\nRun the command:\nsystemctl daemon-reload\n"],"status":"FAIL","actual_value":"not-found\n","expected_result":"'enabled' Is present OR 'disabled' Is present","scored":true,"IsMultiple":false,"reason":"not-found\n"},{"test_number":"1.5.2","test_desc":"Ensure XD/NX support is enabled","SubChecks":null,"audit_type":"","audit":"journalctl | grep 'protection: active'","type":"","test_info":["On 32 bit systems install a kernel with PAE support, no installation is required on 64 bit systems:\n            If necessary configure your bootloader to load the new kernel and reboot the system.\n            You may need to enable NX or XD support in your bios.\n"],"status":"PASS","actual_value":"Oct 08 16:51:28 nixos kernel: NX (Execute Disable) protection: active\n","expected_result":"'' has 'kernel: NX (Execute Disable) protection: active'","scored":true,"IsMultiple":false},{"test_number":"1.5.3.a","test_desc":"Ensure address space layout randomization (ASLR) is enabled","SubChecks":null,"audit_type":"","audit":"sysctl kernel.randomize_va_space","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nkernel.randomize_va_space = 2\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w kernel.randomize_va_space=2\n"],"status":"PASS","actual_value":"kernel.randomize_va_space = 2\n","expected_result":"'kernel.randomize_va_space' is equal to '2'","scored":true,"IsMultiple":false},{"test_number":"1.5.3.b","test_desc":"Ensure address space layout randomization (ASLR) is enabled","SubChecks":null,"audit_type":"","audit":"grep \"kernel\\.randomize_va_space\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nkernel.randomize_va_space = 2\n\nRun the following command to set the active kernel parameter:\n\n# sysctl -w kernel.randomize_va_space=2\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'kernel.randomize_va_space' is equal to '2'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"1.5.4","test_desc":"Ensure prelink is disabled","SubChecks":[{"audit_type":"","audit":"rpm -q prelink","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s prelink","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show prelink","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":2,"fail":5,"warn":1,"info":0},{"section":"1.6","desc":"Mandatory Access Control","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"1.6.1","desc":"Ensure Mandatory Access Control Software is Installed","Constraints":null,"type":"","results":[{"test_number":"1.6.1.1","test_desc":"Ensure SELinux or AppArmor are installed","SubChecks":[{"audit_type":"","audit":"rpm -q libselinux","type":"","Constraints":{"lsm":["selinux"],"platform":["rhel7"]}},{"audit_type":"","audit":"rpm -q apparmor","type":"","Constraints":{"lsm":["apparmor"],"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s libselinux1","type":"","Constraints":{"lsm":["selinux"],"platform":["ubuntu16"]}},{"audit_type":"","audit":"dpkg -s apparmor","type":"","Constraints":{"lsm":["apparmor"],"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show libselinux1","type":"","Constraints":{"lsm":["selinux"],"platform":["ubuntu18"]}},{"audit_type":"","audit":"apt-cache show apparmor","type":"","Constraints":{"lsm":["apparmor"],"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":0,"fail":0,"warn":1,"info":0},{"section":"1.6.2","desc":"Configure SELinux","Constraints":null,"type":"","results":[{"test_number":"1.6.2.1","test_desc":"Ensure SELinux is not disabled in bootloader configuration","SubChecks":[{"audit_type":"","audit":"grep \"^\\s*kernel\" /boot/grub/menu.lst","type":"","Constraints":{"boot":["grub"],"lsm":["selinux"]}},{"audit_type":"","audit":"grep \"^\\s*linux\" /boot/grub2/grub.cfg","type":"","Constraints":{"boot":["grub2"],"lsm":["selinux"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.2.2.a","test_desc":"Ensure the SELinux state is enforcing","SubChecks":[{"audit_type":"","audit":"grep SELINUX=enforcing /etc/selinux/config","type":"","Constraints":{"lsm":["selinux"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.2.2.b","test_desc":"Ensure the SELinux state is enforcing","SubChecks":[{"audit_type":"","audit":"sestatus","type":"","Constraints":{"lsm":["selinux"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.2.3.a","test_desc":"Ensure SELinux policy is configured","SubChecks":[{"audit_type":"","audit":"grep SELINUXTYPE=targeted /etc/selinux/config","type":"","Constraints":{"lsm":["selinux"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.2.3.b","test_desc":"Ensure SELinux policy is configured","SubChecks":[{"audit_type":"","audit":"sestatus","type":"","Constraints":{"lsm":["selinux"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.2.4","test_desc":"Ensure SETroubleshoot is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q setroubleshoot","type":"","Constraints":{"lsm":["selinux"],"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s setroubleshoot","type":"","Constraints":{"lsm":["selinux"],"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show setroubleshoot","type":"","Constraints":{"lsm":["selinux"],"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.2.5","test_desc":"Ensure the MCS Translation Service (mcstrans) is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q mcstrans","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s mcstrans","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show mcstrans","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.2.6","test_desc":"Ensure no unconfined daemons exist","SubChecks":null,"audit_type":"","audit":"ps -eZ | egrep \"initrc\" | grep -E -v -w \"tr|ps|egrep|bash|awk \" | tr ':' ' ' | awk '{ print $NF }'","type":"","test_info":["Investigate any unconfined daemons found during the audit action. They may need to have an existing security context assigned to them or a policy built for them.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false}],"pass":1,"fail":0,"warn":7,"info":0},{"section":"1.6.3","desc":"Configure AppArmor","Constraints":null,"type":"","results":[{"test_number":"1.6.3.1","test_desc":"Ensure AppArmor is not disabled in bootloader configuration","SubChecks":[{"audit_type":"","audit":"grep \"^\\s*kernel\" /boot/grub/menu.lst","type":"","Constraints":{"boot":["grub"],"lsm":["apparmor"]}},{"audit_type":"","audit":"grep LINUX /etc/default/grub","type":"","Constraints":{"boot":["grub2"],"lsm":["apparmor"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"1.6.3.2","test_desc":"Ensure all AppArmor Profiles are enforcing","SubChecks":[{"audit_type":"","audit":"apparmor_status","type":"manual","Constraints":{"lsm":["apparmor"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":0,"fail":0,"warn":2,"info":0},{"section":"1.7","desc":"Warning Banners","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"1.7.1","desc":"Command Line Warning Banners","Constraints":null,"type":"","results":[{"test_number":"1.7.1.1.a","test_desc":"Ensure message of the day is configured properly","SubChecks":null,"audit_type":"","audit":"cat /etc/motd","type":"manual","test_info":["Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , or \\v.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"1.7.1.1.b","test_desc":"Ensure message of the day is configured properly","SubChecks":null,"audit_type":"","audit":"grep -E -i \"(\\\\v|\\\\r|\\\\m|\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/motd","type":"","test_info":["Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , or \\v.\n"],"status":"FAIL","actual_value":"grep: warning: stray \\ before v\ngrep: warning: stray \\ before r\ngrep: warning: stray \\ before m\ngrep: /etc/motd: No such file or directory\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: warning: stray \\ before v\ngrep: warning: stray \\ before r\ngrep: warning: stray \\ before m\ngrep: /etc/motd: No such file or directory\n"},{"test_number":"1.7.1.2.a","test_desc":"Ensure local login warning banner is configured properly","SubChecks":null,"audit_type":"","audit":"cat /etc/issue","type":"manual","test_info":["Edit the /etc/issue file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , or \\v :\n# echo \"Authorized uses only. All activity may be monitored and reported.\" \u003e /etc/issue\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"1.7.1.2.b","test_desc":"Ensure local login warning banner is configured properly","SubChecks":null,"audit_type":"","audit":"grep -E -i \"(\\\\v|\\\\r|\\\\m|\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/issue","type":"","test_info":["Edit the /etc/issue file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , or \\v :\n# echo \"Authorized uses only. All activity may be monitored and reported.\" \u003e /etc/issue\n"],"status":"FAIL","actual_value":"grep: warning: stray \\ before v\ngrep: warning: stray \\ before r\ngrep: warning: stray \\ before m\n\u001b[1;32m\u003c\u003c\u003c Welcome to NixOS 24.05.20241006.ecbc1ca (\\m) - \\l \u003e\u003e\u003e\u001b[0m\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"1.7.1.3.a","test_desc":"Ensure remote login warning banner is configured properly","SubChecks":null,"audit_type":"","audit":"cat /etc/issue.net","type":"manual","test_info":["Edit the /etc/issue.net file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , or \\v :\n# echo \"Authorized uses only. All activity may be monitored and reported.\" \u003e /etc/issue.net\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"1.7.1.3.b","test_desc":"Ensure remote login warning banner is configured properly","SubChecks":null,"audit_type":"","audit":"grep -E -i \"(\\\\v|\\\\r|\\\\m|\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/issue.net","type":"","test_info":["Edit the /etc/issue.net file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , or \\v :\n# echo \"Authorized uses only. All activity may be monitored and reported.\" \u003e /etc/issue.net\n"],"status":"FAIL","actual_value":"grep: warning: stray \\ before v\ngrep: warning: stray \\ before r\ngrep: warning: stray \\ before m\ngrep: /etc/issue.net: No such file or directory\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: warning: stray \\ before v\ngrep: warning: stray \\ before r\ngrep: warning: stray \\ before m\ngrep: /etc/issue.net: No such file or directory\n"},{"test_number":"1.7.1.4","test_desc":"Ensure permissions on /etc/motd are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/motd","type":"","test_info":["Run the following commands to set permissions on `/etc/motd` :\n# chown root:root /etc/motd\n# chmod 644 /etc/motd\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/motd': No such file or directory\n","expected_result":"'644/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/motd': No such file or directory\n"},{"test_number":"1.7.1.5","test_desc":"Ensure permissions on /etc/issue are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/issue","type":"","test_info":["Run the following commands to set permissions on /etc/issue :\n# chown root:root /etc/issue\n# chmod 644 /etc/issue\n"],"status":"FAIL","actual_value":"777/Uid:root/0Gid:root/0\n","expected_result":"'644/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false},{"test_number":"1.7.1.6","test_desc":"Ensure permissions on /etc/issue.net are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/issue.net","type":"","test_info":["Run the following commands to set permissions on /etc/issue.net :\n# chown root:root /etc/issue.net\n# chmod 644 /etc/issue.net\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/issue.net': No such file or directory\n","expected_result":"'644/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/issue.net': No such file or directory\n"},{"test_number":"1.7.2","test_desc":"Ensure GDM login banner is configured","SubChecks":null,"audit_type":"","audit":"grep -v ^#.* /etc/gdm3/greeter.dconf-defaults","type":"","test_info":["Edit or create the file /etc/gdm3/greeter.dconf-defaults and add the following:\n[org/gnome/login-screen]\nbanner-message-enable=true\nbanner-message-text='Authorized uses only. All activity may be monitored and reported.'\n"],"status":"FAIL","actual_value":"grep: /etc/gdm3/greeter.dconf-defaults: No such file or directory\n","expected_result":"'[org/gnome/login-screen]' Is present AND 'banner-message-enable=true' Is present AND 'banner-message-text' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/gdm3/greeter.dconf-defaults: No such file or directory\n"}],"pass":0,"fail":7,"warn":3,"info":0},{"section":"1.8","desc":"Ensure updates, patches, and additional security software are installed","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"2","desc":"Services","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"2.1","desc":"inetd Services","Constraints":null,"type":"","results":[{"test_number":"2.1.1.a","test_desc":"Ensure chargen services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^chargen\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `chargen` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `chargen` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.1.1.b","test_desc":"Ensure chargen services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^chargen\" /etc/xinetd.conf /etc/xinetd.* ","type":"","test_info":["Comment out or remove any lines starting with `chargen` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `chargen` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false},{"test_number":"2.1.2.a","test_desc":"Ensure daytime services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^daytime\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `daytime` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `daytime` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.1.2.b","test_desc":"Ensure daytime services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^daytime\" /etc/xinetd.conf /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `daytime` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `daytime` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false},{"test_number":"2.1.3.a","test_desc":"Ensure discard services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^discard\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `discard` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `discard` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.1.3.b","test_desc":"Ensure discard services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^discard\" /etc/xinetd.conf /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `discard` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `discard` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false},{"test_number":"2.1.4.a","test_desc":"Ensure echo services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^echo\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `echo` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `echo` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.1.4.b","test_desc":"Ensure echo services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^echo\" /etc/xinetd.conf /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `echo` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `echo` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false},{"test_number":"2.1.5.a","test_desc":"Ensure time services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^time\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `time` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `time` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.1.5.b","test_desc":"Ensure time services are not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^time\" /etc/xinetd.conf /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `time` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `time` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false},{"test_number":"2.1.6.a","test_desc":"Ensure rsh server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^shell\" /etc/inetd.*; grep -R \"^login\" /etc/inetd.*; grep -R \"^exec\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `shell` , `login` , or `exec` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `rsh` , `rlogin` , and `rexec` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"grep: /etc/inetd.*: No such file or directory\ngrep: /etc/inetd.*: No such file or directory\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: /etc/inetd.*: No such file or directory\ngrep: /etc/inetd.*: No such file or directory\n"},{"test_number":"2.1.6.b","test_desc":"Ensure rsh server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^shell\" /etc/xinetd.*; grep -R \"^login\" /etc/xinetd.*; grep -R \"^exec\" /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `shell` , `login` , or `exec` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `rsh` , `rlogin` , and `rexec` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"grep: /etc/xinetd.*: No such file or directory\ngrep: /etc/xinetd.*: No such file or directory\n","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false,"reason":"grep: /etc/xinetd.*: No such file or directory\ngrep: /etc/xinetd.*: No such file or directory\n"},{"test_number":"2.1.7.a","test_desc":"Ensure talk server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^talk\" /etc/inetd.*; grep -R \"^ntalk\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `talk` or `ntalk` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `talk` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"grep: /etc/inetd.*: No such file or directory\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: /etc/inetd.*: No such file or directory\n"},{"test_number":"2.1.7.b","test_desc":"Ensure talk server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^talk\" /etc/xinetd.*; grep -R \"^ntalk\" /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `talk` or `ntalk` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `talk` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"grep: /etc/xinetd.*: No such file or directory\n","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false,"reason":"grep: /etc/xinetd.*: No such file or directory\n"},{"test_number":"2.1.8.a","test_desc":"Ensure telnet server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^telnet\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `telnet` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `telnet` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.1.8.b","test_desc":"Ensure telnet server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^telnet\" /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `telnet` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `telnet` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false},{"test_number":"2.1.9.a","test_desc":"Ensure tftp server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^tftp\" /etc/inetd.*","type":"","test_info":["Comment out or remove any lines starting with `tftp` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `tftp` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.1.9.b","test_desc":"Ensure tftp server is not enabled","SubChecks":null,"audit_type":"","audit":"grep -Rs \"^tftp\" /etc/xinetd.*","type":"","test_info":["Comment out or remove any lines starting with `tftp` from `/etc/inetd.conf` and `/etc/inetd.d/*` .\n            Set `disable = yes` on all `tftp` services in `/etc/xinetd.conf` and `/etc/xinetd.d/*` .\n"],"status":"FAIL","actual_value":"","expected_result":"'disable' is equal to 'yes'","scored":true,"IsMultiple":false},{"test_number":"2.1.10","test_desc":"Ensure xinetd service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list xinetd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled xinetd","type":"","Constraints":{"platform":["ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep xinetd","type":"","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":7,"fail":11,"warn":1,"info":0},{"section":"2.2","desc":"Special Purpose Services","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"2.2.1","desc":"Time Synchronization","Constraints":null,"type":"","results":[{"test_number":"2.2.1.1.a","test_desc":"Ensure time synchronization is in use","SubChecks":[{"audit_type":"","audit":"rpm -q ntp","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s ntp","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show ntp","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.1.1.b","test_desc":"Ensure time synchronization is in use","SubChecks":[{"audit_type":"","audit":"rpm -q chrony","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s chrony","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show chrony","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.1.2.a","test_desc":"Ensure ntp is configured","SubChecks":null,"audit_type":"","audit":"grep ^restrict /etc/ntp.conf","type":"","test_info":["Add or edit restrict lines in `/etc/ntp.conf` to match the following:\n\nrestrict -4 default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery\n\nAdd or edit server or pool lines to `/etc/ntp.conf` as appropriate:\n\nserver\n\nConfigure `ntp` to run as the `ntp` user by adding or editing one of the following files as appropriate for your distribution:\n`/etc/sysconfig/ntpd` :\n\nOPTIONS=\"-u ntp:ntp\"\n\n`/etc/sysconfig/ntp` :\n\nNTPD_OPTIONS=\"-u ntp:ntp\"\n\n`/etc/init.d/ntp`:\n\nRUNASUSER=ntp\n"],"status":"FAIL","actual_value":"grep: /etc/ntp.conf: No such file or directory\n","expected_result":"'restrict -4 default kod nomodify notrap nopeer noquery' Is present AND 'restrict -6 default kod nomodify notrap nopeer noquery' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/ntp.conf: No such file or directory\n"},{"test_number":"2.2.1.2.b","test_desc":"Ensure ntp is configured","SubChecks":null,"audit_type":"","audit":"grep -E \"^(server|pool)\" /etc/ntp.conf","type":"manual","test_info":["Add or edit restrict lines in `/etc/ntp.conf` to match the following:\n\nrestrict -4 default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery\n\nAdd or edit server or pool lines to `/etc/ntp.conf` as appropriate:\n\nserver\n\nConfigure `ntp` to run as the `ntp` user by adding or editing one of the following files as appropriate for your distribution:\n`/etc/sysconfig/ntpd` :\n\nOPTIONS=\"-u ntp:ntp\"\n\n`/etc/sysconfig/ntp` :\n\nNTPD_OPTIONS=\"-u ntp:ntp\"\n\n`/etc/init.d/ntp`:\n\nRUNASUSER=ntp\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"2.2.1.2.c","test_desc":"Ensure ntp is configured","SubChecks":[{"audit_type":"","audit":"grep ^OPTIONS /etc/sysconfig/ntpd","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"grep ^OPTIONS /etc/default/ntp","type":"","Constraints":{"platform":["ubuntu16","ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.1.2.d","test_desc":"Ensure ntp is configured","SubChecks":[{"audit_type":"","audit":"grep ^NTPD_OPTIONS /etc/sysconfig/ntp","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"grep ^NTPD_OPTIONS /etc/default/ntp","type":"","Constraints":{"platform":["ubuntu16","ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.1.2.e","test_desc":"Ensure ntp is configured","SubChecks":null,"audit_type":"","audit":"grep RUNASUSER=ntp /etc/init.d/ntp","type":"","test_info":["Add or edit restrict lines in `/etc/ntp.conf` to match the following:\n\nrestrict -4 default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery\n\nAdd or edit server or pool lines to `/etc/ntp.conf` as appropriate:\n\nserver\n\nConfigure `ntp` to run as the `ntp` user by adding or editing one of the following files as appropriate for your distribution:\n`/etc/sysconfig/ntpd` :\n\nOPTIONS=\"-u ntp:ntp\"\n\n`/etc/sysconfig/ntp` :\n\nNTPD_OPTIONS=\"-u ntp:ntp\"\n\n`/etc/init.d/ntp`:\n\nRUNASUSER=ntp\n"],"status":"FAIL","actual_value":"grep: /etc/init.d/ntp: No such file or directory\n","expected_result":"'RUNASUSER' is equal to 'ntp'","scored":true,"IsMultiple":false,"reason":"grep: /etc/init.d/ntp: No such file or directory\n"},{"test_number":"2.2.1.3.a","test_desc":"Ensure chrony is configured","SubChecks":null,"audit_type":"","audit":"grep -E \"^(server|pool)\" /etc/chrony.conf","type":"manual","test_info":["Add or edit server or pool lines to `/etc/chrony.conf` as appropriate:\n\nserver\n\nConfigure `chrony` to run as the `chrony` user by configuring the appropriate startup script for your distribution. Startup scripts are typically stored in `/etc/init.d` or `/etc/systemd`.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"2.2.1.3.b","test_desc":"Ensure chrony is configured","SubChecks":null,"audit_type":"","audit":"ps -ef | grep chronyd","type":"manual","test_info":["Add or edit server or pool lines to `/etc/chrony.conf` as appropriate:\n\nserver\n\nConfigure `chrony` to run as the `chrony` user by configuring the appropriate startup script for your distribution. Startup scripts are typically stored in `/etc/init.d` or `/etc/systemd`.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"2.2.1.4.a","test_desc":"Ensure systemd-timesyncd is configured","SubChecks":null,"audit_type":"","audit":"systemctl is-enabled systemd-timesyncd.service","type":"","test_info":["Run the following command to enable systemd-timesyncd\nsystemctl enable systemd-timesyncd.service\nedit the file /etc/systemd/timesyncd.conf and add/modify the following lines:\nNTP=0.debian.pool.ntp.org 1.debian.pool.ntp.org #Servers listed should be In Accordence With Local Policy\nFallbackNTP=2.debian.pool.ntp.org 3.debian.pool.ntp.org #Servers listed should be In Accordence With Local Policy\nRootDistanceMax=1 #should be In Accordence With Local Policy\nRun the following commands to start systemd-timesyncd.service\n# systemctl start systemd-timesyncd.service\n# timedatectl set-ntp true\n"],"status":"PASS","actual_value":"enabled\n","expected_result":"'enabled' Is present","scored":true,"IsMultiple":false},{"test_number":"2.2.1.4.b","test_desc":"Ensure systemd-timesyncd is configured","SubChecks":null,"audit_type":"","audit":"timedatectl status","type":"manual","test_info":["Run the following command to enable systemd-timesyncd\nsystemctl enable systemd-timesyncd.service\nedit the file /etc/systemd/timesyncd.conf and add/modify the following lines:\nNTP=0.debian.pool.ntp.org 1.debian.pool.ntp.org #Servers listed should be In Accordence With Local Policy\nFallbackNTP=2.debian.pool.ntp.org 3.debian.pool.ntp.org #Servers listed should be In Accordence With Local Policy\nRootDistanceMax=1 #should be In Accordence With Local Policy\nRun the following commands to start systemd-timesyncd.service\n# systemctl start systemd-timesyncd.service\n# timedatectl set-ntp true\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"2.2.2","test_desc":"Ensure X Window System is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q xorg-x11*","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -l xserver-xorg*","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache policy xserver-xorg* | grep Installed -B1","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.3","test_desc":"Ensure Avahi service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list avahi-daemon","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled avahi-daemon","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep avahi-daemon","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.4","test_desc":"Ensure cups service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list cups","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled cups","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep cups","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.5","test_desc":"Ensure DHCP service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list dhcpd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled dhcpd","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep dhcpd","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.6","test_desc":"Ensure LDAP service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list slapd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled slapd","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep slapd","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.7.a","test_desc":"Ensure NFS and RPC are not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list nfs","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled nfs","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep nfs","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.7.b","test_desc":"Ensure NFS and RPC are not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list rpcbind","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled rpcbind","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep rpcbind","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.8","test_desc":"Ensure DNS service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list named","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled named","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep named","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.9","test_desc":"Ensure FTP service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list vsftpd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled vsftpd","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep vsftpd","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.10","test_desc":"Ensure HTTP service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list httpd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled httpd","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep httpd","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.11","test_desc":"Ensure IMAP and POP3 service are not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list dovecot","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled dovecot","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep dovecot","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.12","test_desc":"Ensure Samba is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list smb","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled smb","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep smb","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.13","test_desc":"Ensure HTTP Proxy Server is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list squid","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled squid","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep squid","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.14","test_desc":"Ensure SNMP Server is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list snmpd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled snmpd","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep snmpd","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.15","test_desc":"Ensure mail transfer agent is configured for local-only mode","SubChecks":null,"audit_type":"","audit":"ss -lntu | grep -E ':25\\\\s' | grep -E -v '\\\\s(127.0.0.1|::1):25\\\\s'\n","type":"","test_info":["Edit `/etc/postfix/main.cf` and add the following line to the RECEIVING MAIL section. If the line already exists, change it to look like the line below:\n\ninet_interfaces = loopback-only\n\nRestart postfix with one of the following commands:\n\n# service postfix restart\n# systemctl restart postfix\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"2.2.16","test_desc":"Ensure rsync service is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list rsyncd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled rsyncd","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep rsyncd","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.2.17","test_desc":"Ensure NIS Server is not enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list ypserv","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled ypserv","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep ypserv","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":2,"fail":2,"warn":24,"info":0},{"section":"2.3","desc":"Service Clients","Constraints":null,"type":"","results":[{"test_number":"2.3.1","test_desc":"Ensure NIS Client is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q ypbind","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s ypbind","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show ypbind","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.3.2","test_desc":"Ensure rsh client is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q rsh","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s rsh-client rsh-redone-client","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show rsh-client rsh-redone-client","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.3.3","test_desc":"Ensure talk client is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q talk","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s talk","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show talk","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.3.4","test_desc":"Ensure telnet client is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q telnet","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s telnet","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show telnet","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"2.3.5","test_desc":"Ensure LDAP client is not installed","SubChecks":[{"audit_type":"","audit":"rpm -q openldap-clients","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s openldap-clients","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show openldap-clients","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":0,"fail":0,"warn":5,"info":0},{"section":"3","desc":"Network Configuration","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"3.1","desc":"Network Parameters (Host Only)etwork Parameters (Host Only)","Constraints":null,"type":"","results":[{"test_number":"3.1.1.a","test_desc":"Ensure IP forwarding is disabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.ip_forward","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.ip_forward = 0\nnet.ipv6.conf.all.forwarding = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.ip_forward=0\n# sysctl -w net.ipv6.conf.all.forwarding=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.ip_forward = 0\n","expected_result":"'net.ipv4.ip_forward' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.1.1.b","test_desc":"Ensure IP forwarding is disabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.ip_forward\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.ip_forward = 0\nnet.ipv6.conf.all.forwarding = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.ip_forward=0\n# sysctl -w net.ipv6.conf.all.forwarding=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv4.ip_forward' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.1.1.c","test_desc":"Ensure IP forwarding is disabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv6.conf.all.forwarding","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.ip_forward = 0\nnet.ipv6.conf.all.forwarding = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.ip_forward=0\n# sysctl -w net.ipv6.conf.all.forwarding=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv6.conf.all.forwarding = 0\n","expected_result":"'net.ipv6.conf.all.forwarding' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.1.1.d","test_desc":"Ensure IP forwarding is disabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv6\\.conf\\.all\\.forwarding\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.ip_forward = 0\nnet.ipv6.conf.all.forwarding = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.ip_forward=0\n# sysctl -w net.ipv6.conf.all.forwarding=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv6.conf.all.forwarding' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.1.2.a","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.all.send_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.send_redirects=0\n# sysctl -w net.ipv4.conf.default.send_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.all.send_redirects = 0\n","expected_result":"'net.ipv4.conf.all.send_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.1.2.b","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.default.send_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.send_redirects=0\n# sysctl -w net.ipv4.conf.default.send_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.default.send_redirects = 0\n","expected_result":"'net.ipv4.conf.default.send_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.1.2.c","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.all\\.send_redirects\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.send_redirects=0\n# sysctl -w net.ipv4.conf.default.send_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.send_redirects=0\n","expected_result":"'net.ipv4.conf.all.send_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.send_redirects=0\n"},{"test_number":"3.1.2.d","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.default\\.send_redirects /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.send_redirects=0\n# sysctl -w net.ipv4.conf.default.send_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: unexpected EOF while looking for matching `\"'\n","expected_result":"'net.ipv4.conf.default.send_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: unexpected EOF while looking for matching `\"'\n"}],"pass":4,"fail":4,"warn":0,"info":0},{"section":"3.2","desc":"Network Parameters (Host and Router)","Constraints":null,"type":"","results":[{"test_number":"3.2.1.a","test_desc":"Ensure source routed packets are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.all.accept_source_route","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.all.accept_source_route = 0\n","expected_result":"'net.ipv4.conf.all.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.1.b","test_desc":"Ensure source routed packets are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.default.accept_source_route","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.default.accept_source_route = 0\n","expected_result":"'net.ipv4.conf.default.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.1.c","test_desc":"Ensure source routed packets are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.all\\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv4.conf.all.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.2.1.d","test_desc":"Ensure source routed packets are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.default\\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/50-default.conf:net.ipv4.conf.default.accept_source_route = 0\n","expected_result":"'net.ipv4.conf.default.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/50-default.conf:net.ipv4.conf.default.accept_source_route = 0\n"},{"test_number":"3.2.1.e","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv6.conf.all.accept_source_route","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv6.conf.all.accept_source_route = 0\n","expected_result":"'net.ipv6.conf.all.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.1.f","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv6.conf.default.accept_source_route","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv6.conf.default.accept_source_route = 0\n","expected_result":"'net.ipv6.conf.default.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.1.g","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv6\\.conf\\.all\\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv6.conf.all.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.2.1.h","test_desc":"Ensure packet redirect sending is disabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv6\\.conf\\.default\\.accept_source_route\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_source_route=0\n# sysctl -w net.ipv4.conf.default.accept_source_route=0\n# sysctl -w net.ipv6.conf.all.accept_source_route=0\n# sysctl -w net.ipv6.conf.default.accept_source_route=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv6.conf.default.accept_source_route' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.2.2.a","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.all.accept_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.all.accept_redirects = 0\n","expected_result":"'net.ipv4.conf.all.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.2.b","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.default.accept_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.default.accept_redirects = 0\n","expected_result":"'net.ipv4.conf.default.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.2.c","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.all\\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.accept_redirects=0\n","expected_result":"'net.ipv4.conf.all.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.accept_redirects=0\n"},{"test_number":"3.2.2.d","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.default\\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.accept_redirects=0\n","expected_result":"'net.ipv4.conf.default.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.accept_redirects=0\n"},{"test_number":"3.2.2.e","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv6.conf.all.accept_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv6.conf.all.accept_redirects = 0\n","expected_result":"'net.ipv6.conf.all.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.2.f","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv6.conf.default.accept_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv6.conf.default.accept_redirects = 0\n","expected_result":"'net.ipv6.conf.default.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.2.g","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv6\\.conf\\.all\\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv6.conf.all.accept_redirects=0\n","expected_result":"'net.ipv6.conf.all.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv6.conf.all.accept_redirects=0\n"},{"test_number":"3.2.2.h","test_desc":"Ensure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv6\\.conf\\.default\\.accept_redirects\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.accept_redirects=0\n# sysctl -w net.ipv4.conf.default.accept_redirects=0\n# sysctl -w net.ipv6.conf.all.accept_redirects=0\n# sysctl -w net.ipv6.conf.default.accept_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv6.conf.default.accept_redirects=0\n","expected_result":"'net.ipv6.conf.default.accept_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv6.conf.default.accept_redirects=0\n"},{"test_number":"3.2.3.a","test_desc":"Ensure secure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.all.secure_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.secure_redirects=0\n# sysctl -w net.ipv4.conf.default.secure_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.all.secure_redirects = 0\n","expected_result":"'net.ipv4.conf.all.secure_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.3.b","test_desc":"Ensure secure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.default.secure_redirects","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.secure_redirects=0\n# sysctl -w net.ipv4.conf.default.secure_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.default.secure_redirects = 0\n","expected_result":"'net.ipv4.conf.default.secure_redirects' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.3.c","test_desc":"Ensure secure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.all\\.secure_redirects\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.secure_redirects=0\n# sysctl -w net.ipv4.conf.default.secure_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.secure_redirects=0\n","expected_result":"'net.ipv4.conf.all.secure_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.secure_redirects=0\n"},{"test_number":"3.2.3.d","test_desc":"Ensure secure ICMP redirects are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.default\\.secure_redirects\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.secure_redirects=0\n# sysctl -w net.ipv4.conf.default.secure_redirects=0\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.secure_redirects=0\n","expected_result":"'net.ipv4.conf.default.secure_redirects' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.secure_redirects=0\n"},{"test_number":"3.2.4.a","test_desc":"Ensure suspicious packets are logged","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.all.log_martians","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.log_martians=1\n# sysctl -w net.ipv4.conf.default.log_martians=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.all.log_martians = 1\n","expected_result":"'net.ipv4.conf.all.log_martians' is equal to '1'","scored":true,"IsMultiple":false},{"test_number":"3.2.4.b","test_desc":"Ensure suspicious packets are logged","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.default.log_martians","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.log_martians=1\n# sysctl -w net.ipv4.conf.default.log_martians=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.default.log_martians = 1\n","expected_result":"'net.ipv4.conf.default.log_martians' is equal to '1'","scored":true,"IsMultiple":false},{"test_number":"3.2.4.c","test_desc":"Ensure suspicious packets are logged","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.all\\.log_martians\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.log_martians=1\n# sysctl -w net.ipv4.conf.default.log_martians=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.log_martians=1\n","expected_result":"'net.ipv4.conf.all.log_martians' is equal to '1'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.log_martians=1\n"},{"test_number":"3.2.4.d","test_desc":"Ensure suspicious packets are logged","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.default\\.log_martians\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.log_martians=1\n# sysctl -w net.ipv4.conf.default.log_martians=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.log_martians=1\n","expected_result":"'net.ipv4.conf.default.log_martians' is equal to '1'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.log_martians=1\n"},{"test_number":"3.2.5.a","test_desc":"Ensure broadcast ICMP requests are ignored","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.icmp_echo_ignore_broadcasts","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.icmp_echo_ignore_broadcasts = 1\n","expected_result":"'net.ipv4.icmp_echo_ignore_broadcasts' is equal to '1'","scored":true,"IsMultiple":false},{"test_number":"3.2.5.b","test_desc":"Ensure broadcast ICMP requests are ignored","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.icmp_echo_ignore_broadcasts\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.icmp_echo_ignore_broadcasts=1\n","expected_result":"'net.ipv4.icmp_echo_ignore_broadcasts' is equal to '1'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.icmp_echo_ignore_broadcasts=1\n"},{"test_number":"3.2.6.a","test_desc":"Ensure bogus ICMP responses are ignored","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.icmp_ignore_bogus_error_responses","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.icmp_ignore_bogus_error_responses = 1\n","expected_result":"'net.ipv4.icmp_ignore_bogus_error_responses' is equal to '1'","scored":true,"IsMultiple":false},{"test_number":"3.2.6.b","test_desc":"Ensure bogus ICMP responses are ignored","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.icmp_ignore_bogus_error_responses\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv4.icmp_ignore_bogus_error_responses' is equal to '1'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.2.7.a","test_desc":"Ensure Reverse Path Filtering is enabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.all.rp_filter","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.rp_filter=1\n# sysctl -w net.ipv4.conf.default.rp_filter=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.all.rp_filter = 1\n","expected_result":"'net.ipv4.conf.all.rp_filter' is equal to '1'","scored":true,"IsMultiple":false},{"test_number":"3.2.7.b","test_desc":"Ensure Reverse Path Filtering is enabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.conf.default.rp_filter","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.rp_filter=1\n# sysctl -w net.ipv4.conf.default.rp_filter=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.conf.default.rp_filter = 1\n","expected_result":"'net.ipv4.conf.default.rp_filter' is equal to '1'","scored":true,"IsMultiple":false},{"test_number":"3.2.7.c","test_desc":"Ensure Reverse Path Filtering is enabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.all\\.rp_filter\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.rp_filter=1\n# sysctl -w net.ipv4.conf.default.rp_filter=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.rp_filter=1\n","expected_result":"'net.ipv4.conf.all.rp_filter' is equal to '1'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.all.rp_filter=1\n"},{"test_number":"3.2.7.d","test_desc":"Ensure Reverse Path Filtering is enabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.conf\\.default\\.rp_filter\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.conf.all.rp_filter=1\n# sysctl -w net.ipv4.conf.default.rp_filter=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/50-default.conf:net.ipv4.conf.default.rp_filter = 2\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.rp_filter=1\n","expected_result":"'net.ipv4.conf.default.rp_filter' is equal to '1'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n/etc/sysctl.d/50-default.conf:net.ipv4.conf.default.rp_filter = 2\n/etc/sysctl.d/60-nixos.conf:net.ipv4.conf.default.rp_filter=1\n"},{"test_number":"3.2.8.a","test_desc":"Ensure TCP SYN Cookies is enabled","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv4.tcp_syncookies","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.tcp_syncookies = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.tcp_syncookies=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"PASS","actual_value":"net.ipv4.tcp_syncookies = 1\n","expected_result":"'net.ipv4.tcp_syncookies' is equal to '1'","scored":true,"IsMultiple":false},{"test_number":"3.2.8.b","test_desc":"Ensure TCP SYN Cookies is enabled","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv4\\.tcp_syncookies\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv4.tcp_syncookies = 1\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv4.tcp_syncookies=1\n# sysctl -w net.ipv4.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv4.tcp_syncookies' is equal to '1'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.2.9.a","test_desc":"Ensure IPv6 router advertisements are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv6.conf.all.accept_ra","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.default.accept_ra = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv6.conf.all.accept_ra=0\n# sysctl -w net.ipv6.conf.default.accept_ra=0\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"net.ipv6.conf.all.accept_ra = 1\n","expected_result":"'net.ipv6.conf.all.accept_ra' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.9.b","test_desc":"Ensure IPv6 router advertisements are not accepted","SubChecks":null,"audit_type":"","audit":"sysctl net.ipv6.conf.default.accept_ra","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.default.accept_ra = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv6.conf.all.accept_ra=0\n# sysctl -w net.ipv6.conf.default.accept_ra=0\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"net.ipv6.conf.default.accept_ra = 1\n","expected_result":"'net.ipv6.conf.default.accept_ra' is equal to '0'","scored":true,"IsMultiple":false},{"test_number":"3.2.9.c","test_desc":"Ensure IPv6 router advertisements are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv6\\.conf\\.all\\.accept_ra\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.default.accept_ra = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv6.conf.all.accept_ra=0\n# sysctl -w net.ipv6.conf.default.accept_ra=0\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv6.conf.all.accept_ra' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"},{"test_number":"3.2.9.d","test_desc":"Ensure IPv6 router advertisements are not accepted","SubChecks":null,"audit_type":"","audit":"grep ^\\s*\"net\\.ipv6\\.conf\\.default\\.accept_ra\" /etc/sysctl.conf /etc/sysctl.d/*","type":"","test_info":["Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*` file:\n\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.default.accept_ra = 0\n\nRun the following commands to set the active kernel parameters:\n\n# sysctl -w net.ipv6.conf.all.accept_ra=0\n# sysctl -w net.ipv6.conf.default.accept_ra=0\n# sysctl -w net.ipv6.route.flush=1\n"],"status":"FAIL","actual_value":"grep: /etc/sysctl.conf: No such file or directory\n","expected_result":"'net.ipv6.conf.default.accept_ra' is equal to '0'","scored":true,"IsMultiple":false,"reason":"grep: /etc/sysctl.conf: No such file or directory\n"}],"pass":17,"fail":21,"warn":0,"info":0},{"section":"3.3","desc":"TCP Wrappers","Constraints":null,"type":"","results":[{"test_number":"3.3.1","test_desc":"Ensure TCP Wrappers is installed","SubChecks":[{"audit_type":"","audit":"rpm -q tcp_wrappers","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s tcpd","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show tcpd","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"3.3.2","test_desc":"Ensure /etc/hosts.allow is configured","SubChecks":null,"audit_type":"","audit":"cat /etc/hosts.allow","type":"manual","test_info":["Run the following command to create `/etc/hosts.allow` :\n\n# echo \"ALL: /, /, ...\" \u003e/etc/hosts.allow\n\nwhere each `/` combination (for example, \"192.168.1.0/255.255.255.0\") represents one network block in use by your organization that requires access to this system.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.3.3","test_desc":"Ensure /etc/hosts.deny is configured","SubChecks":null,"audit_type":"","audit":"cat /etc/hosts.deny","type":"","test_info":["Run the following command to create `/etc/hosts.deny` :\n\n# echo \"ALL: ALL\" \u003e\u003e /etc/hosts.deny\n"],"status":"WARN","actual_value":"cat: /etc/hosts.deny: No such file or directory\n","expected_result":"'ALL: ALL' Is present","scored":false,"IsMultiple":false,"reason":"cat: /etc/hosts.deny: No such file or directory\n"},{"test_number":"3.3.4","test_desc":"Ensure permissions on /etc/hosts.allow are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/hosts.allow","type":"","test_info":["Run the following commands to set permissions on `/etc/hosts.allow` :\n\n# chown root:root /etc/hosts.allow\n# chmod 644 /etc/hosts.allow\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/hosts.allow': No such file or directory\n","expected_result":"'644/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/hosts.allow': No such file or directory\n"},{"test_number":"3.3.5","test_desc":"Ensure permissions on /etc/hosts.deny are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/hosts.deny","type":"","test_info":["Run the following commands to set permissions on `/etc/hosts.deny` :\n\n# chown root:root /etc/hosts.deny\n# chmod 644 /etc/hosts.deny\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/hosts.deny': No such file or directory\n","expected_result":"'644/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/hosts.deny': No such file or directory\n"}],"pass":0,"fail":2,"warn":3,"info":0},{"section":"3.4","desc":"Uncommon Network Protocols","Constraints":null,"type":"","results":[{"test_number":"3.4.1.a","test_desc":"Ensure DCCP is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v dccp","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall dccp /bin/true\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/dccp/dccp.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"3.4.1.b","test_desc":"Ensure DCCP is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep dccp","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall dccp /bin/true\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"3.4.2.a","test_desc":"Ensure SCTP is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v sctp","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall sctp /bin/true\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/ipv4/udp_tunnel.ko.xz \ninsmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/ipv6/ip6_udp_tunnel.ko.xz \ninsmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/sctp/sctp.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"3.4.2.b","test_desc":"Ensure SCTP is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep sctp","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall sctp /bin/true\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"3.4.3.a","test_desc":"Ensure RDS is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v rds","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall rds /bin/true\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/rds/rds.ko.xz \n","expected_result":"'install /bin/true' is equal to 'install /bin/true'","scored":true,"IsMultiple":false},{"test_number":"3.4.3.b","test_desc":"Ensure RDS is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep rds","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall rds /bin/true\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"3.4.4.a","test_desc":"Ensure TIPC is disabled","SubChecks":null,"audit_type":"","audit":"modprobe -n -v tipc","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall tipc /bin/true\n"],"status":"FAIL","actual_value":"insmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/ipv4/udp_tunnel.ko.xz \ninsmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/ipv6/ip6_udp_tunnel.ko.xz \ninsmod /run/booted-system/kernel-modules/lib/modules/6.6.54/kernel/net/tipc/tipc.ko.xz \n","expected_result":"'install /bin/true' Is present","scored":true,"IsMultiple":false},{"test_number":"3.4.4.b","test_desc":"Ensure TIPC is disabled","SubChecks":null,"audit_type":"","audit":"lsmod | grep tipc","type":"","test_info":["Edit or create the file `/etc/modprobe.d/CIS.conf` and add the following line:\n\ninstall tipc /bin/true\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false}],"pass":4,"fail":4,"warn":0,"info":0},{"section":"3.5","desc":"Firewall Configuration","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"3.5.1","desc":"Configure IPv6 ip6tables","Constraints":null,"type":"","results":[{"test_number":"3.5.1.1","test_desc":"Ensure IPv6 default deny firewall policy","SubChecks":null,"audit_type":"","audit":"ip6tables -L","type":"","test_info":["Run the following commands to implement a default DROP policy:\n\n# iptables -P INPUT DROP\n# iptables -P OUTPUT DROP\n# iptables -P FORWARD DROP\n"],"status":"FAIL","actual_value":"ip6tables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)\n","expected_result":"'Chain INPUT (policy DROP)' Is present AND 'Chain FORWARD (policy DROP)' Is present AND 'Chain OUTPUT (policy DROP)' Is present","scored":true,"IsMultiple":false,"reason":"ip6tables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)\n"},{"test_number":"3.5.1.2.a","test_desc":"Ensure IPv6 loopback traffic is configured","SubChecks":null,"audit_type":"","audit":"ip6tables -L INPUT -v -n","type":"manual","test_info":["Run the following commands to implement the loopback rules:\n\n# ip6tables -A INPUT -i lo -j ACCEPT\n# ip6tables -A OUTPUT -o lo -j ACCEPT\n# ip6tables -A INPUT -s ::1 -j DROP\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.1.2.b","test_desc":"Ensure IPv6 loopback traffic is configured","SubChecks":null,"audit_type":"","audit":"ip6tables -L OUTPUT -v -n","type":"manual","test_info":["Run the following commands to implement the loopback rules:\n\n# ip6tables -A INPUT -i lo -j ACCEPT\n# ip6tables -A OUTPUT -o lo -j ACCEPT\n# ip6tables -A INPUT -s ::1 -j DROP\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.1.3","test_desc":"Ensure IPv6 outbound and established connections are configured","SubChecks":null,"audit_type":"","audit":"ip6tables -L -v -n","type":"manual","test_info":["Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections:\n\n# ip6tables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.1.4.a","test_desc":"Ensure IPv6 firewall rules exist for all open ports","SubChecks":null,"audit_type":"","audit":"ss -6tuln","type":"manual","test_info":["For each port identified in the audit which does not have a firewall rule establish a proper\nrule for accepting inbound connections:\n\n# ip6tables -A INPUT -p \u003cprotocol\u003e --dport \u003cport\u003e -m state --state NEW -j ACCEPT\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.1.4.b","test_desc":"Ensure IPv6 firewall rules exist for all open ports","SubChecks":null,"audit_type":"","audit":"ip6tables -L INPUT -v -n","type":"manual","test_info":["For each port identified in the audit which does not have a firewall rule establish a proper\nrule for accepting inbound connections:\n\n# ip6tables -A INPUT -p \u003cprotocol\u003e --dport \u003cport\u003e -m state --state NEW -j ACCEPT\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"}],"pass":0,"fail":1,"warn":5,"info":0},{"section":"3.5.2","desc":"Configure IPv4 iptables","Constraints":null,"type":"","results":[{"test_number":"3.5.2.1","test_desc":"Ensure default deny firewall policy","SubChecks":null,"audit_type":"","audit":"iptables -L","type":"","test_info":["Run the following commands to implement a default DROP policy:\n\n# iptables -P INPUT DROP\n# iptables -P OUTPUT DROP\n# iptables -P FORWARD DROP\n"],"status":"FAIL","actual_value":"iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)\n","expected_result":"'Chain INPUT (policy DROP)' Is present AND 'Chain FORWARD (policy DROP)' Is present AND 'Chain OUTPUT (policy DROP)' Is present","scored":true,"IsMultiple":false,"reason":"iptables v1.8.10 (nf_tables): Could not fetch rule set generation id: Permission denied (you must be root)\n"},{"test_number":"3.5.2.2.a","test_desc":"Ensure loopback traffic is configured","SubChecks":null,"audit_type":"","audit":"iptables -L INPUT -v -n","type":"manual","test_info":["Run the following commands to implement the loopback rules:\n\n# iptables -A INPUT -i lo -j ACCEPT\n# iptables -A OUTPUT -o lo -j ACCEPT\n# iptables -A INPUT -s 127.0.0.0/8 -j DROP\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.2.2.b","test_desc":"Ensure loopback traffic is configured","SubChecks":null,"audit_type":"","audit":"iptables -L OUTPUT -v -n","type":"manual","test_info":["Run the following commands to implement the loopback rules:\n\n# iptables -A INPUT -i lo -j ACCEPT\n# iptables -A OUTPUT -o lo -j ACCEPT\n# iptables -A INPUT -s 127.0.0.0/8 -j DROP\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.2.3","test_desc":"Ensure outbound and established connections are configured","SubChecks":null,"audit_type":"","audit":"iptables -L -v -n","type":"manual","test_info":["Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections:\n\n# iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.2.4.a","test_desc":"Ensure firewall rules exist for all open ports","SubChecks":null,"audit_type":"","audit":"netstat -ln","type":"manual","test_info":["For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections:\n\n# iptables -A INPUT -p  --dport  -m state --state NEW -j ACCEPT\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.2.4.b","test_desc":"Ensure firewall rules exist for all open ports","SubChecks":null,"audit_type":"","audit":"iptables -L INPUT -v -n","type":"manual","test_info":["For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections:\n\n# iptables -A INPUT -p  --dport  -m state --state NEW -j ACCEPT\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.5.3","test_desc":"Ensure iptables is installed","SubChecks":[{"audit_type":"","audit":"rpm -q iptables","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s iptables","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show iptables","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "}],"pass":0,"fail":1,"warn":6,"info":0},{"section":"3.6","desc":"Ensure wireless interfaces are disabled (Not Scored)","Constraints":null,"type":"","results":[{"test_number":"3.6.a","test_desc":"Ensure wireless interfaces are disabled","SubChecks":null,"audit_type":"","audit":"iwconfig","type":"manual","test_info":["Run the following command to disable any wireless interfaces:\n\n# ip link set  down\n\nDisable any wireless interfaces in your network configuration.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"3.6.b","test_desc":"Ensure wireless interfaces are disabled","SubChecks":null,"audit_type":"","audit":"ip link show up","type":"manual","test_info":["Run the following command to disable any wireless interfaces:\n\n# ip link set  down\n\nDisable any wireless interfaces in your network configuration.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"}],"pass":0,"fail":0,"warn":2,"info":0},{"section":"3.7","desc":"Ensure wireless interfaces are disabled (Not Scored)","Constraints":null,"type":"","results":[{"test_number":"3.7","test_desc":"Disable IPv6","SubChecks":[{"audit_type":"","audit":"grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v ipv6.disabled=1","type":"","Constraints":{"boot":["grub"]}},{"audit_type":"","audit":"grep \"^\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disabled=1","type":"","Constraints":{"boot":["grub2"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"grep: /boot/grub/grub.cfg: Permission denied\n","expected_result":"'' is equal to ''","scored":false,"IsMultiple":false,"reason":"grep: /boot/grub/grub.cfg: Permission denied\n"}],"pass":0,"fail":0,"warn":1,"info":0},{"section":"4","desc":"Logging and Auditing","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"4.1","desc":"Configure System Accounting (auditd)","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"4.1.1","desc":"Configure Data Retention","Constraints":null,"type":"","results":[{"test_number":"4.1.1.1","test_desc":"Ensure audit log storage size is configured","SubChecks":null,"audit_type":"","audit":"grep max_log_file /etc/audit/auditd.conf","type":"manual","test_info":["Set the following parameter in `/etc/audit/auditd.conf` in accordance with site policy:\n\nmax_log_file =\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"4.1.1.2.a","test_desc":"Ensure system is disabled when audit logs are full","SubChecks":null,"audit_type":"","audit":"grep ^space_left_action /etc/audit/auditd.conf","type":"","test_info":["Set the following parameters in `/etc/audit/auditd.conf:`\n\nspace_left_action = email\naction_mail_acct = root\nadmin_space_left_action = halt\n"],"status":"FAIL","actual_value":"grep: /etc/audit/auditd.conf: No such file or directory\n","expected_result":"'space_left_action = email' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/auditd.conf: No such file or directory\n"},{"test_number":"4.1.1.2.b","test_desc":"Ensure system is disabled when audit logs are full","SubChecks":null,"audit_type":"","audit":"grep action_mail_acct /etc/audit/auditd.conf","type":"","test_info":["Set the following parameters in `/etc/audit/auditd.conf:`\n\nspace_left_action = email\naction_mail_acct = root\nadmin_space_left_action = halt\n"],"status":"FAIL","actual_value":"grep: /etc/audit/auditd.conf: No such file or directory\n","expected_result":"'action_mail_acct = root' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/auditd.conf: No such file or directory\n"},{"test_number":"4.1.1.2.c","test_desc":"Ensure system is disabled when audit logs are full","SubChecks":null,"audit_type":"","audit":"grep admin_space_left_action /etc/audit/auditd.conf","type":"","test_info":["Set the following parameters in `/etc/audit/auditd.conf:`\n\nspace_left_action = email\naction_mail_acct = root\nadmin_space_left_action = halt\n"],"status":"FAIL","actual_value":"grep: /etc/audit/auditd.conf: No such file or directory\n","expected_result":"'admin_space_left_action = halt' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/auditd.conf: No such file or directory\n"},{"test_number":"4.1.1.3","test_desc":"Ensure audit logs are not automatically deleted","SubChecks":null,"audit_type":"","audit":"grep max_log_file_action /etc/audit/auditd.conf","type":"","test_info":["Set the following parameter in `/etc/audit/auditd.conf:`\n\nmax_log_file_action = keep_logs\n"],"status":"FAIL","actual_value":"grep: /etc/audit/auditd.conf: No such file or directory\n","expected_result":"'max_log_file_action = keep_logs' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/auditd.conf: No such file or directory\n"},{"test_number":"4.1.2","test_desc":"Ensure auditd service is enabled","SubChecks":[{"audit_type":"","audit":"rpm -q audit audit-libs","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg -s auditd audispd-plugins","type":"","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-cache show auditd","type":"","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"4.1.3","test_desc":"Ensure auditd service is enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list auditd","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled auditd","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep auditd","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"4.1.4","test_desc":"Ensure auditing for processes that start prior to auditd is enabled","SubChecks":[{"audit_type":"","audit":"grep \"^\\s*kernel\" /boot/grub/menu.lst","type":"","Constraints":{"boot":["grub"]}},{"audit_type":"","audit":"grep -i linux /etc/default/grub","type":"","Constraints":{"boot":["grub2"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"FAIL","actual_value":"grep: /boot/grub/menu.lst: Permission denied\n","expected_result":"'audit=1' Is present","scored":true,"IsMultiple":false,"reason":"grep: /boot/grub/menu.lst: Permission denied\n"},{"test_number":"4.1.5.a","test_desc":"Ensure events that modify date and time information are collected","SubChecks":null,"audit_type":"","audit":"grep time-change /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change\n-a always,exit -F arch=b64 -S clock_settime -k time-change\n-a always,exit -F arch=b32 -S clock_settime -k time-change\n-w /etc/localtime -p wa -k time-change\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change' Is present AND '-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change' Is present AND '-a always,exit -F arch=b64 -S clock_settime -k time-change' Is present AND '-a always,exit -F arch=b32 -S clock_settime -k time-change' Is present AND '-w /etc/localtime -p wa -k time-change' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.5.b","test_desc":"Ensure events that modify date and time information are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep time-change","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change\n-a always,exit -F arch=b64 -S clock_settime -k time-change\n-a always,exit -F arch=b32 -S clock_settime -k time-change\n-w /etc/localtime -p wa -k time-change\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=time-change' Is present AND '-a always,exit -F arch=b32 -S stime,settimeofday,adjtimex -F key=time-change' Is present AND '-a always,exit -F arch=b64 -S clock_settime -F key=time-change' Is present AND '-a always,exit -F arch=b32 -S clock_settime -F key=time-change' Is present AND '-w /etc/localtime -p wa -k time-change' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.6.a","test_desc":"Ensure events that modify user/group information are collected","SubChecks":null,"audit_type":"","audit":"grep identity /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-w /etc/group -p wa -k identity' Is present AND '-w /etc/passwd -p wa -k identity' Is present AND '-w /etc/gshadow -p wa -k identity' Is present AND '-w /etc/shadow -p wa -k identity' Is present AND '-w /etc/security/opasswd -p wa -k identity' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.6.b","test_desc":"Ensure events that modify user/group information are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep identity","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-w /etc/group -p wa -k identity' Is present AND '-w /etc/passwd -p wa -k identity' Is present AND '-w /etc/gshadow -p wa -k identity' Is present AND '-w /etc/shadow -p wa -k identity' Is present AND '-w /etc/security/opasswd -p wa -k identity' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.7.a","test_desc":"Ensure events that modify the system's network environment are collected","SubChecks":null,"audit_type":"","audit":"grep system-locale /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/sysconfig/network -p wa -k system-locale\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale' Is present AND '-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale' Is present AND '-w /etc/issue -p wa -k system-locale' Is present AND '-w /etc/issue.net -p wa -k system-locale' Is present AND '-w /etc/hosts -p wa -k system-locale' Is present AND '-w /etc/sysconfig/network -p wa -k system-locale' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.7.b","test_desc":"Ensure events that modify the system's network environment are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep system-locale","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/sysconfig/network -p wa -k system-locale\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale' Is present AND '-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale' Is present AND '-w /etc/issue -p wa -k system-locale' Is present AND '-w /etc/issue.net -p wa -k system-locale' Is present AND '-w /etc/hosts -p wa -k system-locale' Is present AND '-w /etc/sysconfig/network -p wa -k system-locale' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.8.a","test_desc":"Ensure events that modify the system's Mandatory Access Controls are collected","SubChecks":[{"audit_type":"","audit":"grep MAC-policy /etc/audit/rules.d/*.rules","type":"","Constraints":{"lsm":["selinux"]}},{"audit_type":"","audit":"grep MAC-policy /etc/audit/rules.d/*.rules","type":"","Constraints":{"lsm":["apparmor"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"4.1.8.b","test_desc":"Ensure events that modify the system's Mandatory Access Controls are collected","SubChecks":[{"audit_type":"","audit":"auditctl -l | grep MAC-policy","type":"","Constraints":{"lsm":["selinux"]}},{"audit_type":"","audit":"auditctl -l | grep MAC-policy","type":"","Constraints":{"lsm":["apparmor"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"4.1.9.a","test_desc":"Ensure login and logout events are collected","SubChecks":null,"audit_type":"","audit":"grep logins /etc/audit/rules.d/*.rules","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/log/tallylog -p wa -k logins\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-w /var/log/faillog -p wa -k logins' Is present AND '-w /var/log/lastlog -p wa -k logins' Is present AND '-w /var/log/tallylog -p wa -k logins' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.9.b","test_desc":"Ensure login and logout events are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep logins","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/log/tallylog -p wa -k logins\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-w /var/log/faillog -p wa -k logins' Is present AND '-w /var/log/lastlog -p wa -k logins' Is present AND '-w /var/log/tallylog -p wa -k logins' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.10.a","test_desc":"Ensure session initiation information is collected","SubChecks":null,"audit_type":"","audit":"grep -E '(session|logins)' /etc/audit/rules.d/*.rules","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k logins\n-w /var/log/btmp -p wa -k logins\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-w /var/run/utmp -p wa -k session' Is present AND '-w /var/log/wtmp -p wa -k logins' Is present AND '-w /var/log/btmp -p wa -k logins' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.10.b","test_desc":"Ensure session initiation information is collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep -E '(session|logins)'","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k logins\n-w /var/log/btmp -p wa -k logins\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-w /var/run/utmp -p wa -k session' Is present AND '-w /var/log/wtmp -p wa -k logins' Is present AND '-w /var/log/btmp -p wa -k logins' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.11.a","test_desc":"Ensure discretionary access control permission modification events are collected","SubChecks":null,"audit_type":"","audit":"grep perm_mod /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid\u003e=500 -F auid!=4294967295 -k perm_mod' Is present AND '-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid\u003e=500 -F auid!=4294967295 -k perm_mod' Is present AND '-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid\u003e=500 -F auid!=4294967295 -k perm_mod' Is present AND '-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid\u003e=500 -F auid!=4294967295 -k perm_mod' Is present AND '-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid\u003e=500 -F auid!=4294967295 -k perm_mod' Is present AND '-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid\u003e=500 -F auid!=4294967295 -k perm_mod' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.11.b","test_desc":"Ensure discretionary access control permission modification events are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep perm_mod","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S lremovexattr -S fremovexattr -F auid\u003e=500 -F auid!=4294967295 -k perm_mod\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid\u003e=500 -F auid!=-1 -F key=perm_mod' Is present AND '-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid\u003e=500 -F auid!=-1 -F key=perm_mod' Is present AND '-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F auid\u003e=500 -F auid!=-1 -F key=perm_mod' Is present AND '-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid\u003e=500 -F auid!=-1 -F key=perm_mod' Is present AND '-a always,exit -F arch=b64 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid\u003e=500 -F auid!=-1 -F key=perm_mod' Is present AND '-a always,exit -F arch=b32 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid\u003e=500 -F auid!=-1 -F key=perm_mod' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.12.a","test_desc":"Ensure unsuccessful unauthorized file access attempts are collected","SubChecks":null,"audit_type":"","audit":"grep access /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid\u003e=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid\u003e=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid\u003e=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid\u003e=500 -F auid!=4294967295 -k access\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid\u003e=500 -F auid!=4294967295 -k access' Is present AND '-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid\u003e=500 -F auid!=4294967295 -k access' Is present AND '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid\u003e=500 -F auid!=4294967295 -k access' Is present AND '-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid\u003e=500 -F auid!=4294967295 -k access' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.12.b","test_desc":"Ensure unsuccessful unauthorized file access attempts are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep access","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid\u003e=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid\u003e=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid\u003e=500 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid\u003e=500 -F auid!=4294967295 -k access\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F exit=-EACCES -F auid\u003e=500 -F auid!=-1 -F key=access' Is present AND '-a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F exit=-EACCES -F auid\u003e=500 -F auid!=-1 -F key=access' Is present AND '-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F exit=-EPERM -F auid\u003e=500 -F auid!=-1 -F key=access' Is present AND '-a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F exit=-EPERM -F auid\u003e=500 -F auid!=-1 -F key=access' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.13","test_desc":"Ensure use of privileged commands is collected","SubChecks":null,"audit_type":"","audit":"find \u003cpartition\u003e -xdev \\( -perm -4000 -o -perm -2000 \\) -type f | awk '{print \"-a always,exit -F path=\" $1 \" -F perm=x -F auid\u003e=500 -F auid!=4294967295  -k privileged\" }' ","type":"manual","test_info":["To remediate this issue, the system administrator will have to execute a find command to\nlocate all the privileged programs and then add an audit line for each one of them.\nThe audit parameters associated with this are as follows:\n-F path=\" $1 \" - will populate each file name found through the find command and\nprocessed by awk. -F perm=x - will write an audit record if the file is executed.\n-F auid\u003e=500 - will write a record if the user executing the command is not a privileged user.\n-F auid!= 4294967295 - will ignore Daemon events\nAll audit records should be tagged with the identifier \"privileged\".\nRun the following command replacing with a list of partitions where programs can be\nexecuted from on your system:\n# find \u003cpartition\u003e -xdev \\( -perm -4000 -o -perm -2000 \\) -type f | awk\n'{print \\\n\"-a always,exit -F path=\" $1 \" -F perm=x -F auid\u003e=500 -F auid!=4294967295 \\\n-k privileged\" }'\nEdit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nAnd add all resulting lines to the file.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"4.1.14.a","test_desc":"Ensure successful file system mounts are collected","SubChecks":null,"audit_type":"","audit":"grep mounts /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S mount -F auid\u003e=500 -F auid!=4294967295 -k mounts\n-a always,exit -F arch=b32 -S mount -F auid\u003e=500 -F auid!=4294967295 -k mounts\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-a always,exit -F arch=b64 -S mount -F auid\u003e=500 -F auid!=4294967295 -k mounts' Is present AND '-a always,exit -F arch=b32 -S mount -F auid\u003e=500 -F auid!=4294967295 -k mounts' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.14.b","test_desc":"Ensure successful file system mounts are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep mounts","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S mount -F auid\u003e=500 -F auid!=4294967295 -k mounts\n-a always,exit -F arch=b32 -S mount -F auid\u003e=500 -F auid!=4294967295 -k mounts\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-a always,exit -F arch=b64 -S mount -F auid\u003e=500 -F auid!=-1 -F key=mounts' Is present AND '-a always,exit -F arch=b32 -S mount -F auid\u003e=500 -F auid!=-1 -F key=mounts' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.15.a","test_desc":"Ensure file deletion events by users are collected","SubChecks":null,"audit_type":"","audit":"grep delete /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid\u003e=500 -F auid!=4294967295 -k delete\n-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid\u003e=500 -F auid!=4294967295 -k delete\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid\u003e=500 -F auid!=4294967295 -k delete' Is present AND '-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid\u003e=500 -F auid!=4294967295 -k delete' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.15.b","test_desc":"Ensure file deletion events by users are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep delete","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid\u003e=500 -F auid!=4294967295 -k delete\n-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid\u003e=500 -F auid!=4294967295 -k delete\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F auid\u003e=500 -F auid!=-1 -F key=delete' Is present AND '-a always,exit -F arch=b32 -S unlink,rename,unlinkat,renameat -F auid\u003e=500 -F auid!=-1 -F key=delete' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.16.a","test_desc":"Ensure changes to system administration scope (sudoers) is collected","SubChecks":null,"audit_type":"","audit":"grep scope /etc/audit/rules.d/*.rules","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d/ -p wa -k scope\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-w /etc/sudoers -p wa -k scope' Is present AND '-w /etc/sudoers.d/ -p wa -k scope' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.16.b","test_desc":"Ensure changes to system administration scope (sudoers) is collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep scope","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d/ -p wa -k scope\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-w /etc/sudoers -p wa -k scope' Is present AND '-w /etc/sudoers.d -p wa -k scope' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.17.a","test_desc":"Ensure system administrator actions (sudolog) are collected","SubChecks":null,"audit_type":"","audit":"grep actions /etc/audit/rules.d/*.rules","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /var/log/sudo.log -p wa -k actions\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-w /var/log/sudo.log -p wa -k actions' is equal to '-w /var/log/sudo.log -p wa -k actions'","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.17.b","test_desc":"Ensure system administrator actions (sudolog) are collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep actions","type":"","test_info":["Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /var/log/sudo.log -p wa -k actions\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-w /var/log/sudo.log -p wa -k actions' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.18.a","test_desc":"Ensure kernel module loading and unloading is collected","SubChecks":null,"audit_type":"","audit":"grep modules /etc/audit/rules.d/*.rules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-w /sbin/insmod -p x -k modules' Is present AND '-w /sbin/rmmod -p x -k modules' Is present AND '-w /sbin/modprobe -p x -k modules' Is present AND '-a always,exit -F arch=b64 -S init_module -S delete_module -k modules' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n"},{"test_number":"4.1.18.b","test_desc":"Ensure kernel module loading and unloading is collected","SubChecks":null,"audit_type":"","audit":"auditctl -l | grep modules","type":"","test_info":["For 64 bit systems Edit or create a file in the /etc/audit/rules.d/ directory ending in .rules\nExample: vi /etc/audit/rules.d/audit.rules\nand add the following lines:\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n"],"status":"FAIL","actual_value":"/bin/sh: line 1: auditctl: command not found\n","expected_result":"'-w /sbin/insmod -p x -k modules' Is present AND '-w /sbin/rmmod -p x -k modules' Is present AND '-w /sbin/modprobe -p x -k modules' Is present AND '-a always,exit -F arch=b64 -S init_module,delete_module -F key=modules' Is present","scored":true,"IsMultiple":false,"reason":"/bin/sh: line 1: auditctl: command not found\n"},{"test_number":"4.1.19","test_desc":"Ensure the audit configuration is immutable","SubChecks":null,"audit_type":"","audit":"grep ^\\s*[^#] /etc/audit/rules.d/*.rules | tail -1","type":"","test_info":["Edit or create the file /etc/audit/rules.d/99-finalize.rules and add the line\n-e 2\nat the end of the file\n"],"status":"FAIL","actual_value":"grep: /etc/audit/rules.d/*.rules: No such file or directory\n","expected_result":"'-e 2' Is present","scored":true,"IsMultiple":false}],"pass":0,"fail":30,"warn":6,"info":0},{"section":"4.2","desc":"Configure Logging","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"4.2.1","desc":"Configure rsyslog","Constraints":null,"type":"","results":[{"test_number":"4.2.1.1","test_desc":"Ensure rsyslog is installed","SubChecks":[{"audit_type":"","audit":"rpm -q rsyslog","type":"","Constraints":{"platform":["rhel7"],"syslog":["rsyslog"]}},{"audit_type":"","audit":"dpkg -s rsyslog","type":"","Constraints":{"platform":["ubuntu16"],"syslog":["rsyslog"]}},{"audit_type":"","audit":"apt-cache show rsyslog","type":"","Constraints":{"platform":["ubuntu18"],"syslog":["rsyslog"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"4.2.1.2","test_desc":"Ensure rsyslog Service is enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list rsyslog","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled rsyslog","type":"","Constraints":{"platform":["rhel7","ubuntu16","ubuntu18"]}},{"audit_type":"","audit":"ls /etc/rc*.d | grep rsyslog","type":"manual","Constraints":{"platform":["ubuntuOptional"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"4.2.1.3","test_desc":"Ensure logging is configured","SubChecks":[{"audit_type":"","audit":"ls -l /var/log/","type":"manual","Constraints":{"syslog":["rsyslog"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false},{"test_number":"4.2.1.4","test_desc":"Ensure rsyslog default file permissions configured","SubChecks":[{"audit_type":"","audit":"grep ^\\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf -h | tr \"$\" \" \" ","type":"","Constraints":{"syslog":["rsyslog"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"FAIL","actual_value":"grep: /etc/rsyslog.conf: No such file or directory\ngrep: /etc/rsyslog.d/*.conf: No such file or directory\n","expected_result":"'FileCreateMode' has a non numeric value: ''","scored":true,"IsMultiple":false},{"test_number":"4.2.1.5","test_desc":"Ensure rsyslog is configured to send logs to a remote log host","SubChecks":[{"audit_type":"","audit":"grep \"^*.*[^I][^I]*@\" /etc/rsyslog.conf /etc/rsyslog.d/*.conf","type":"manual","Constraints":{"syslog":["rsyslog"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false},{"test_number":"4.2.1.6.a","test_desc":"Ensure remote rsyslog messages are only accepted on designated log hosts.","SubChecks":[{"audit_type":"","audit":"grep ^\\$ModLoad /etc/rsyslog.conf /etc/rsyslog.d/*.conf","type":"","Constraints":{"syslog":["rsyslog"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"grep: /etc/rsyslog.conf: No such file or directory\ngrep: /etc/rsyslog.d/*.conf: No such file or directory\n","expected_result":"'\\$ModLoad imtcp' Is present","scored":false,"IsMultiple":false,"reason":"grep: /etc/rsyslog.conf: No such file or directory\ngrep: /etc/rsyslog.d/*.conf: No such file or directory\n"},{"test_number":"4.2.1.6.b","test_desc":"Ensure remote rsyslog messages are only accepted on designated log hosts.","SubChecks":[{"audit_type":"","audit":"grep ^\\$InputTCPServerRun /etc/rsyslog.conf /etc/rsyslog.d/*.conf","type":"","Constraints":{"syslog":["rsyslog"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"grep: /etc/rsyslog.conf: No such file or directory\ngrep: /etc/rsyslog.d/*.conf: No such file or directory\n","expected_result":"'\\$InputTCPServerRun 514' Is present","scored":false,"IsMultiple":false,"reason":"grep: /etc/rsyslog.conf: No such file or directory\ngrep: /etc/rsyslog.d/*.conf: No such file or directory\n"}],"pass":0,"fail":1,"warn":6,"info":0},{"section":"4.2.2","desc":"Configure journald","Constraints":null,"type":"","results":[{"test_number":"4.2.2.1","test_desc":"Ensure journald is configured to send logs to rsyslog","SubChecks":null,"audit_type":"","audit":"grep -e ForwardToSyslog /etc/systemd/journald.conf","type":"","test_info":["Edit the /etc/systemd/journald.conf file and add the following line:\nForwardToSyslog=yes\n"],"status":"FAIL","actual_value":"","expected_result":"'ForwardToSyslog=yes' Is present","scored":true,"IsMultiple":false},{"test_number":"4.2.2.2","test_desc":"Ensure journald is configured to compress large log files (Scored)","SubChecks":null,"audit_type":"","audit":"grep -e Compress /etc/systemd/journald.conf","type":"","test_info":["Edit the /etc/systemd/journald.conf file and add the following line:\nCompress=yes\n"],"status":"FAIL","actual_value":"","expected_result":"'Compress=yes' Is present","scored":true,"IsMultiple":false},{"test_number":"4.2.2.3","test_desc":"Ensure journald is configured to write logfiles to persistent disk","SubChecks":null,"audit_type":"","audit":"grep -e Storage /etc/systemd/journald.conf","type":"","test_info":["Edit the /etc/systemd/journald.conf file and add the following line:\nStorage=persistent\n"],"status":"PASS","actual_value":"Storage=persistent\n","expected_result":"'Storage=persistent' Is present","scored":true,"IsMultiple":false},{"test_number":"4.2.3","test_desc":"Ensure permissions on all logfiles are configured","SubChecks":null,"audit_type":"","audit":"find /var/log -type f -ls","type":"manual","test_info":["Run the following commands to set permissions on all existing log files:\nfind /var/log -type f -exec chmod g-wx,o-rwx \"{}\" + -o -type d -exec chmod g-w,o-rwx \"{}\" +\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"4.3","test_desc":"Ensure logrotate is configured","SubChecks":null,"audit_type":"","audit":"cat /etc/logrotate.conf; cat /etc/logrotate.d/* ;","type":"manual","test_info":["Edit `/etc/logrotate.conf` and `/etc/logrotate.d/*` to ensure logs are rotated according to site policy.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"}],"pass":1,"fail":2,"warn":2,"info":0},{"section":"5","desc":"Access, Authentication and Authorization","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"5.1","desc":"Configure cron","Constraints":null,"type":"","results":[{"test_number":"5.1.1","test_desc":"Ensure cron daemon is enabled","SubChecks":[{"audit_type":"","audit":"chkconfig --list crond","type":"","Constraints":{"platform":["rhel6"]}},{"audit_type":"","audit":"systemctl is-enabled crond","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"systemctl is-enabled cron","type":"","Constraints":{"platform":["ubuntu16","ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"5.1.2","test_desc":"Ensure permissions on /etc/crontab are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/crontab","type":"","test_info":["Run the following commands to set ownership and permissions on `/etc/crontab` :\n\n# chown root:root /etc/crontab\n# chmod og-rwx /etc/crontab\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/crontab': No such file or directory\n","expected_result":"'600/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/crontab': No such file or directory\n"},{"test_number":"5.1.3","test_desc":"Ensure permissions on /etc/cron.hourly are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/cron.hourly","type":"","test_info":["Run the following commands to set ownership and permissions on `/etc/cron.hourly` :\n\n# chown root:root /etc/cron.hourly\n# chmod og-rwx /etc/cron.hourly\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/cron.hourly': No such file or directory\n","expected_result":"'700/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/cron.hourly': No such file or directory\n"},{"test_number":"5.1.4","test_desc":"Ensure permissions on /etc/cron.daily are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/cron.daily","type":"","test_info":["Run the following commands to set ownership and permissions on `/etc/cron.daily` :\n\n# chown root:root /etc/cron.daily\n# chmod og-rwx /etc/cron.daily\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/cron.daily': No such file or directory\n","expected_result":"'700/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/cron.daily': No such file or directory\n"},{"test_number":"5.1.5","test_desc":"Ensure permissions on /etc/cron.weekly are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/cron.weekly","type":"","test_info":["Run the following commands to set ownership and permissions on `/etc/cron.weekly` :\n\n# chown root:root /etc/cron.weekly\n# chmod og-rwx /etc/cron.weekly\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/cron.weekly': No such file or directory\n","expected_result":"'700/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/cron.weekly': No such file or directory\n"},{"test_number":"5.1.6","test_desc":"Ensure permissions on /etc/cron.monthly are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/cron.monthly","type":"","test_info":["Run the following commands to set ownership and permissions on `/etc/cron.monthly` :\n\n# chown root:root /etc/cron.monthly\n# chmod og-rwx /etc/cron.monthly\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/cron.monthly': No such file or directory\n","expected_result":"'700/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/cron.monthly': No such file or directory\n"},{"test_number":"5.1.7","test_desc":"Ensure permissions on /etc/cron.d are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/cron.d","type":"","test_info":["Run the following commands to set ownership and permissions on `/etc/cron.d` :\n\n# chown root:root /etc/cron.d\n# chmod og-rwx /etc/cron.d\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/cron.d': No such file or directory\n","expected_result":"'700/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/cron.d': No such file or directory\n"},{"test_number":"5.1.8.a","test_desc":"Ensure at/cron is restricted to authorized users","SubChecks":null,"audit_type":"","audit":"stat /etc/cron.deny","type":"","test_info":["Run the following commands to remove `/etc/cron.deny` and `/etc/at.deny` and create and set permissions and ownership for `/etc/cron.allow` and `/etc/at.allow` :\n\n# rm /etc/cron.deny\n# rm /etc/at.deny\n# touch /etc/cron.allow\n# touch /etc/at.allow\n# chmod og-rwx /etc/cron.allow\n# chmod og-rwx /etc/at.allow\n# chown root:root /etc/cron.allow\n# chown root:root /etc/at.allow\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/cron.deny': No such file or directory\n","expected_result":"'stat: cannot stat '/etc/cron.deny': No such file or directory' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/cron.deny': No such file or directory\n"},{"test_number":"5.1.8.b","test_desc":"Ensure at/cron is restricted to authorized users","SubChecks":null,"audit_type":"","audit":"stat /etc/at.deny","type":"","test_info":["Run the following commands to remove `/etc/cron.deny` and `/etc/at.deny` and create and set permissions and ownership for `/etc/cron.allow` and `/etc/at.allow` :\n\n# rm /etc/cron.deny\n# rm /etc/at.deny\n# touch /etc/cron.allow\n# touch /etc/at.allow\n# chmod og-rwx /etc/cron.allow\n# chmod og-rwx /etc/at.allow\n# chown root:root /etc/cron.allow\n# chown root:root /etc/at.allow\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/at.deny': No such file or directory\n","expected_result":"'stat: cannot stat '/etc/at.deny': No such file or directory' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/at.deny': No such file or directory\n"},{"test_number":"5.1.8.c","test_desc":"Ensure at/cron is restricted to authorized users","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/cron.allow","type":"","test_info":["Run the following commands to remove `/etc/cron.deny` and `/etc/at.deny` and create and set permissions and ownership for `/etc/cron.allow` and `/etc/at.allow` :\n\n# rm /etc/cron.deny\n# rm /etc/at.deny\n# touch /etc/cron.allow\n# touch /etc/at.allow\n# chmod og-rwx /etc/cron.allow\n# chmod og-rwx /etc/at.allow\n# chown root:root /etc/cron.allow\n# chown root:root /etc/at.allow\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/cron.allow': No such file or directory\n","expected_result":"'600/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/cron.allow': No such file or directory\n"},{"test_number":"5.1.8.d","test_desc":"Ensure at/cron is restricted to authorized users","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/at.allow","type":"","test_info":["Run the following commands to remove `/etc/cron.deny` and `/etc/at.deny` and create and set permissions and ownership for `/etc/cron.allow` and `/etc/at.allow` :\n\n# rm /etc/cron.deny\n# rm /etc/at.deny\n# touch /etc/cron.allow\n# touch /etc/at.allow\n# chmod og-rwx /etc/cron.allow\n# chmod og-rwx /etc/at.allow\n# chown root:root /etc/cron.allow\n# chown root:root /etc/at.allow\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/at.allow': No such file or directory\n","expected_result":"'600/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/at.allow': No such file or directory\n"}],"pass":0,"fail":10,"warn":1,"info":0},{"section":"5.2","desc":"SSH Server Configuration","Constraints":null,"type":"","results":[{"test_number":"5.2.1","test_desc":"Ensure permissions on /etc/ssh/sshd_config are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/ssh/sshd_config","type":"","test_info":["Run the following commands to set ownership and permissions on `/etc/ssh/sshd_config`:\n\n# chown root:root /etc/ssh/sshd_config\n# chmod og-rwx /etc/ssh/sshd_config\n"],"status":"FAIL","actual_value":"777/Uid:root/0Gid:root/0\n","expected_result":"'600/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false},{"test_number":"5.2.2","test_desc":"Ensure permissions on SSH private host key files are configured","SubChecks":null,"audit_type":"","audit":"find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec stat -c \"%N permissions=%a Uid:%U/%u Gid:%G/%g\" {} \\;","type":"","test_info":["Run the following commands to set ownership and permissions on the private SSH host key files\n# find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:root {} \\;\n# find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod 0600 {} \\;\n"],"status":"PASS","actual_value":"'/etc/ssh/ssh_host_ed25519_key' permissions=600 Uid:root/0 Gid:root/0\n'/etc/ssh/ssh_host_rsa_key' permissions=600 Uid:root/0 Gid:root/0\n","expected_result":"'Uid:root/0 Gid:root/0' Is present AND 'permissions' has permissions 600, expected 600 or more restrictive","scored":true,"IsMultiple":true},{"test_number":"5.2.3","test_desc":"Ensure permissions on SSH public host key files are configured","SubChecks":null,"audit_type":"","audit":"find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec stat -c \"%N permissions=%a Uid:%U/%u Gid:%G/%g\" {} \\;","type":"","test_info":["Run the following commands to set permissions and ownership on the SSH host public key files\n# find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod 0644 {} \\;\n#find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown root:root {} \\;\n"],"status":"FAIL","actual_value":"'/etc/ssh/ssh_host_ed25519_key.pub' permissions=644 Uid:root/0 Gid:root/0\n'/etc/ssh/ssh_host_rsa_key.pub' permissions=644 Uid:root/0 Gid:root/0\n","expected_result":"'Uid:root/0 Gid:root/0' Is present AND 'permissions' has permissions 644, expected 600 or more restrictive","scored":true,"IsMultiple":true},{"test_number":"5.2.4","test_desc":"Ensure SSH Protocol is set to 2","SubChecks":null,"audit_type":"","audit":"grep ^Protocol /etc/ssh/sshd_config","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\nProtocol 2\n"],"status":"FAIL","actual_value":"","expected_result":"'Protocol 2' Is present","scored":true,"IsMultiple":false},{"test_number":"5.2.5","test_desc":"Ensure SSH LogLevel is set to INFO","SubChecks":null,"audit_type":"","audit":"grep ^LogLevel /etc/ssh/sshd_config","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\nLogLevel VERBOSE\nOR\nLogLevel INFO\n"],"status":"PASS","actual_value":"LogLevel INFO\n","expected_result":"'LogLevel VERBOSE' Is present OR 'LogLevel INFO' Is present","scored":true,"IsMultiple":false},{"test_number":"5.2.6","test_desc":"Ensure SSH X11 forwarding is disabled","SubChecks":null,"audit_type":"","audit":"grep ^X11Forwarding /etc/ssh/sshd_config","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\nX11Forwarding no\n"],"status":"PASS","actual_value":"X11Forwarding no\n","expected_result":"'X11Forwarding no' Is present","scored":true,"IsMultiple":false},{"test_number":"5.2.7","test_desc":"Ensure SSH MaxAuthTries is set to 4 or less","SubChecks":null,"audit_type":"","audit":"sshd -T | grep maxauthtries","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\nMaxAuthTries 4\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"Invalid Number(s) used for comparison: '' '4'","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.8","test_desc":"Ensure SSH IgnoreRhosts is enabled","SubChecks":null,"audit_type":"","audit":"sshd -T | grep ignorerhosts","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\nIgnoreRhosts yes\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'ignorerhosts yes' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.9","test_desc":"Ensure SSH HostbasedAuthentication is disabled","SubChecks":null,"audit_type":"","audit":"sshd -T | grep hostbasedauthentication","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\nhostbasedauthentication no\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'hostbasedauthentication no' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.10","test_desc":"Ensure SSH root login is disabled","SubChecks":null,"audit_type":"","audit":"sshd -T | grep permitrootlogin","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\npermitrootlogin no\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'permitrootlogin no' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.11","test_desc":"Ensure SSH PermitEmptyPasswords is disabled","SubChecks":null,"audit_type":"","audit":"sshd -T | grep permitemptypasswords","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\npermitemptypasswords no\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'permitemptypasswords no' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.12","test_desc":"Ensure SSH PermitUserEnvironment is disabled","SubChecks":null,"audit_type":"","audit":"sshd -T | grep permituserenvironment","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\npermituserenvironment no\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'permituserenvironment no' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.13","test_desc":"Ensure only approved MAC algorithms are used","SubChecks":null,"audit_type":"","audit":"sshd -T | grep ciphers","type":"","test_info":["Edit the /etc/ssh/sshd_config file add/modify the Ciphers line to contain a comma\nseparated list of the site approved ciphers\nExample:\nCiphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n"],"status":"PASS","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'3des-cbc' Is not present AND 'aes128-cbc' Is not present AND 'aes192-cbc' Is not present AND 'aes256-cbc' Is not present AND 'arcfour' Is not present AND 'arcfour128' Is not present AND 'arcfour256' Is not present AND 'blowfish-cbc' Is not present AND 'cast128-cbc' Is not present AND 'rijndael-cbc@lysator.liu.se' Is not present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.14","test_desc":"Ensure only strong MAC algorithms are used","SubChecks":null,"audit_type":"","audit":"sshd -T | grep -i \"MACs\"","type":"","test_info":["Edit the /etc/ssh/sshd_config file and add/modify the MACs line to contain a comma\nseparated list of the site approved MACs\nExample:\nMACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n"],"status":"PASS","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'hmac-md5' Is not present AND 'hmac-md5-96' Is not present AND 'hmac-ripemd160' Is not present AND 'hmac-sha1' Is not present AND 'hmac-sha1-96' Is not present AND 'umac-64@openssh.com' Is not present AND 'umac-128@openssh.com' Is not present AND 'hmac-md5-etm@openssh.com' Is not present AND 'hmac-md5-96-etm@openssh.com' Is not present AND 'hmac-ripemd160-etm@openssh.com' Is not present AND 'hmac-sha1-etm@openssh.com' Is not present AND 'hmac-sha1-96-etm@openssh.com' Is not present AND 'umac-64-etm@openssh.com' Is not present AND 'umac-128-etm@openssh.com' Is not present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.15","test_desc":"Ensure only strong Key Exchange algorithms are used","SubChecks":null,"audit_type":"","audit":"sshd -T | grep kexalgorithms","type":"","test_info":["Edit the /etc/ssh/sshd_config file add/modify the KexAlgorithms line to contain a comma\nseparated list of the site approved key exchange algorithms\nExample:\nKexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-\ngroup14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-\nsha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-\nhellman-group-exchange-sha256\n"],"status":"PASS","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'diffie-hellman-group1-sha1' Is not present AND 'diffie-hellman-group14-sha1' Is not present AND 'diffie-hellman-group-exchange-sha1' Is not present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.16.a","test_desc":"Ensure SSH Idle Timeout Interval is configured","SubChecks":null,"audit_type":"","audit":"sshd -T | grep clientaliveinterval","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameters according to site policy:\n\nclientaliveinterval 300\nclientalivecountmax 0\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"Invalid Number(s) used for comparison: '' '300' AND Invalid Number(s) used for comparison: '' '1'","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.16.b","test_desc":"Ensure SSH Idle Timeout Interval is configured","SubChecks":null,"audit_type":"","audit":"sshd -T | grep clientalivecountmax","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameters according to site policy:\n\nclientaliveinterval 300\nclientalivecountmax 0\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"Invalid Number(s) used for comparison: '' '3'","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.17","test_desc":"Ensure SSH LoginGraceTime is set to one minute or less","SubChecks":null,"audit_type":"","audit":"sshd -T | grep logingracetime","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\nlogingracetime 60\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"Invalid Number(s) used for comparison: '' '60'","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.18","test_desc":"Ensure SSH access is limited","SubChecks":null,"audit_type":"","audit":"sshd -T | grep -e allowusers -e allowgroups -e denyusers -e denygroups","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set one or more of the parameter as follows:\nAllowUsers\nAllowGroups\nDenyUsers\nDenyGroups\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'' matched by regex expression '[aA]llow[uU]sers' AND '' matched by regex expression '[aA]llow[gG]roups' AND '' matched by regex expression '[dD]eny[uU]sers' AND '' matched by regex expression '[dD]eny[gG]roups'","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.19","test_desc":"Ensure SSH warning banner is configured","SubChecks":null,"audit_type":"","audit":"sshd -T | grep banner","type":"","test_info":["Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\nbanner /etc/issue.net\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'banner /etc/issue.net' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.20","test_desc":"Ensure SSH PAM is enabled","SubChecks":null,"audit_type":"","audit":"sshd -T | grep -i usepam","type":"","test_info":["Edit the /etc/ssh/sshd_config file to set the parameter as follows:\nUsePAM yes\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'usepam yes' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.21","test_desc":"Ensure SSH AllowTcpForwarding is disabled","SubChecks":null,"audit_type":"","audit":"sshd -T | grep -i allowtcpforwarding","type":"","test_info":["Edit the /etc/ssh/sshd_config file to set the parameter as follows:\nallowtcpforwarding no\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'allowtcpforwarding no' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.22","test_desc":"Ensure SSH MaxStartups is configured","SubChecks":null,"audit_type":"","audit":"sshd -T | grep -i maxstartups","type":"","test_info":["Edit the /etc/ssh/sshd_config file to set the parameter as follows:\nmaxstartups 10:30:60\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"'maxstartups 10:30:60' Is present","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"},{"test_number":"5.2.23","test_desc":"Ensure SSH MaxSessions is set to 4 or less","SubChecks":null,"audit_type":"","audit":"sshd -T | grep -i maxsessions","type":"","test_info":["Edit the /etc/ssh/sshd_config file to set the parameter as follows:\nMaxSessions 4\n"],"status":"FAIL","actual_value":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n","expected_result":"Invalid Number(s) used for comparison: '' '4'","scored":true,"IsMultiple":false,"reason":"Unable to load host key: /etc/ssh/ssh_host_rsa_key\r\nUnable to load host key: /etc/ssh/ssh_host_ed25519_key\r\nsshd: no hostkeys available -- exiting.\r\n"}],"pass":6,"fail":18,"warn":0,"info":0},{"section":"5.3","desc":"Configure PAM","Constraints":null,"type":"","results":[{"test_number":"5.3.1","test_desc":"Ensure password creation requirements are configured","SubChecks":null,"audit_type":"","audit":"cat /etc/pam.d/common-password; cat /etc/pam.d/system-auth; cat /etc/security/pwquality.conf","type":"","test_info":["Set password creation requirements to conform to site policy. Many distributions provide tools for updating PAM configuration, consult your documentation for details. If no tooling is provided edit the appropriate `/etc/pam.d/` configuration file and add or modify the `pam_cracklib.so` or `pam_pwquality.so` lines to include the required options:\n\npassword required pam_cracklib.so try_first_pass retry=3 minlen=14 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1\npassword requisite pam_pwquality.so try_first_pass retry=3\nIf `pam_pwquality.so` is in use also configure settings in `/etc/security/pwquality.conf` :\nminlen = 14\ndcredit = -1\nucredit = -1\nocredit = -1\nlcredit = -1\n"],"status":"FAIL","actual_value":"cat: /etc/pam.d/common-password: No such file or directory\ncat: /etc/pam.d/system-auth: No such file or directory\ncat: /etc/security/pwquality.conf: No such file or directory\n","expected_result":"Invalid Number(s) used for comparison: '' '14' AND Invalid Number(s) used for comparison: '' '3' AND 'dcredit' is equal to '-1' AND 'ucredit' is equal to '-1' AND 'ocredit' is equal to '-1' AND 'lcredit' is equal to '-1'","scored":true,"IsMultiple":false,"reason":"cat: /etc/pam.d/common-password: No such file or directory\ncat: /etc/pam.d/system-auth: No such file or directory\ncat: /etc/security/pwquality.conf: No such file or directory\n"},{"test_number":"5.3.2","test_desc":"Ensure lockout for failed password attempts is configured","SubChecks":null,"audit_type":"","audit":"cat /etc/pam.d/system-auth; cat /etc/pam.d/password-auth; cat /etc/pam.d/common-auth","type":"manual","test_info":["Set password lockouts to conform to site policy. Many distributions provide tools for updating PAM configuration, consult your documentation for details. If no tooling is provided edit the appropriate `/etc/pam.d/` configuration file and add or modify the `pam_tally2.so` or `pam_faillock.so` lines as appropriate:\n\nauth required pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900\n\n\nauth required pam_faillock.so preauth audit silent deny=5 unlock_time=900\nauth sufficient pam_unix.so\nauth [default=die] pam_faillock.so authfail audit deny=5 unlock_time=900\nauth sufficient pam_faillock.so authsucc audit deny=5 unlock_time=900\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"5.3.3","test_desc":"Ensure password reuse is limited","SubChecks":null,"audit_type":"","audit":"cat /etc/pam.d/common-password; cat /etc/pam.d/system-auth","type":"manual","test_info":["Set remembered password history to conform to site policy. Many distributions provide tools for updating PAM configuration, consult your documentation for details. If no tooling is provided edit the appropriate `/etc/pam.d/` configuration file and add or modify the `pam_pwhistory.so` or `pam_unix.so` lines to include the `remember` option:\n\npassword required pam_pwhistory.so remember=5\npassword sufficient pam_unix.so remember=5\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"5.3.4","test_desc":"Ensure password hashing algorithm is SHA-512","SubChecks":null,"audit_type":"","audit":"grep -E ^[^#].*sha512 /etc/pam.d/common-password /etc/pam.d/system-auth /etc/pam.d/password-auth","type":"","test_info":["Set password hashing algorithm to sha512. Many distributions provide tools for updating PAM configuration, consult your documentation for details. If no tooling is provided edit the appropriate `/etc/pam.d/` configuration file and add or modify the `pam_unix.so` lines to include the sha512 option:\n\npassword sufficient pam_unix.so sha512\n"],"status":"WARN","actual_value":"grep: /etc/pam.d/common-password: No such file or directory\ngrep: /etc/pam.d/system-auth: No such file or directory\ngrep: /etc/pam.d/password-auth: No such file or directory\n","expected_result":"'sha512' Is present","scored":false,"IsMultiple":false,"reason":"grep: /etc/pam.d/common-password: No such file or directory\ngrep: /etc/pam.d/system-auth: No such file or directory\ngrep: /etc/pam.d/password-auth: No such file or directory\n"}],"pass":0,"fail":1,"warn":3,"info":0},{"section":"5.4","desc":"User Accounts and Environment","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"5.4.1","desc":"Set Shadow Password Suite Parameters","Constraints":null,"type":"","results":[{"test_number":"5.4.1.1.a","test_desc":"Ensure password expiration is 365 days or less","SubChecks":null,"audit_type":"","audit":"grep ^PASS_MAX_DAYS /etc/login.defs","type":"","test_info":["Set the `PASS_MAX_DAYS` parameter to conform to site policy in `/etc/login.defs` :\n\nPASS_MAX_DAYS 356\n\nModify user parameters for all users with a password set to match:\n\n# chage --maxdays 356\n"],"status":"FAIL","actual_value":"","expected_result":"Invalid Number(s) used for comparison: '' '365'","scored":true,"IsMultiple":false},{"test_number":"5.4.1.1.b","test_desc":"Ensure password expiration is 365 days or less","SubChecks":null,"audit_type":"","audit":"grep -E '^[^:]+:[^!*]' /etc/shadow | cut -d: -f1,5","type":"manual","test_info":["Set the `PASS_MAX_DAYS` parameter to conform to site policy in `/etc/login.defs` :\n\nPASS_MAX_DAYS 365\n\nModify user parameters for all users with a password set to match:\n\n# chage --maxdays 365\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"5.4.1.2.a","test_desc":"Ensure minimum days between password changes is 7 or more","SubChecks":null,"audit_type":"","audit":"grep ^PASS_MIN_DAYS /etc/login.defs","type":"","test_info":["Set the `PASS_MIN_DAYS` parameter to 7 in `/etc/login.defs` :\n\nPASS_MIN_DAYS 7\n\nModify user parameters for all users with a password set to match:\n\n# chage --mindays 7\n"],"status":"FAIL","actual_value":"","expected_result":"Invalid Number(s) used for comparison: '' '7'","scored":true,"IsMultiple":false},{"test_number":"5.4.1.2.b","test_desc":"Ensure minimum days between password changes is 7 or more","SubChecks":null,"audit_type":"","audit":"grep -E ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1,4","type":"manual","test_info":["Set the `PASS_MIN_DAYS` parameter to 7 in `/etc/login.defs` :\n\nPASS_MIN_DAYS 7\n\nModify user parameters for all users with a password set to match:\n\n# chage --mindays 7\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"5.4.1.3.a","test_desc":"Ensure password expiration warning days is 7 or more","SubChecks":null,"audit_type":"","audit":"grep ^PASS_WARN_AGE /etc/login.defs","type":"","test_info":["Set the `PASS_WARN_AGE` parameter to 7 in `/etc/login.defs` :\n\nPASS_WARN_AGE 7\n\nModify user parameters for all users with a password set to match:\n\n# chage --warndays 7\n"],"status":"FAIL","actual_value":"","expected_result":"Invalid Number(s) used for comparison: '' '7'","scored":true,"IsMultiple":false},{"test_number":"5.4.1.3.b","test_desc":"Ensure password expiration warning days is 7 or more","SubChecks":null,"audit_type":"","audit":"grep -E ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1,6","type":"manual","test_info":["Set the `PASS_WARN_AGE` parameter to 7 in `/etc/login.defs` :\n\nPASS_WARN_AGE 7\n\nModify user parameters for all users with a password set to match:\n\n# chage --warndays 7\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"5.4.1.4.a","test_desc":"Ensure inactive password lock is 30 days or less","SubChecks":null,"audit_type":"","audit":"useradd -D | grep INACTIVE","type":"","test_info":["Run the following command to set the default password inactivity period to 30 days:\n\n# useradd -D -f 30\n\nModify user parameters for all users with a password set to match:\n\n# chage --inactive 30\n"],"status":"PASS","actual_value":"INACTIVE=-1\n","expected_result":"'INACTIVE' is lower or equal to 30","scored":true,"IsMultiple":false},{"test_number":"5.4.1.4.b","test_desc":"Ensure inactive password lock is 30 days or less","SubChecks":null,"audit_type":"","audit":"grep -E ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1,7","type":"manual","test_info":["Run the following command to set the default password inactivity period to 30 days:\n\n# useradd -D -f 30\n\nModify user parameters for all users with a password set to match:\n\n# chage --inactive 30\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"5.4.1.5","test_desc":"Ensure all users last password change date is in the past","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\nfor usr in $(cut -d: -f1 /etc/shadow | sort -u ); do\n        p=$(chage --list $usr | grep '^Last password change' | cut -d: -f2)\n        today=$(date +'%b %d %Y')\n        if [ $(date --date=\"$p\" +%s) -gt $(date --date=\"$today\" +%s) ]; then\n            echo \"$usr : $p\"\n        fi\n        done\n","type":"","test_info":["Investigate any users with a password change date in the future and correct them. Locking the account, expiring the password, or resetting the password manually may be appropriate.\n"],"status":"FAIL","actual_value":"cut: /etc/shadow: Permission denied\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"5.4.2.a","test_desc":"Ensure system accounts are non-login","SubChecks":null,"audit_type":"","audit":"awk -F: '($1!=\"root\" \u0026\u0026 $1!=\"sync\" \u0026\u0026 $1!=\"shutdown\" \u0026\u0026 $1!=\"halt\" \u0026\u0026 $1!~/^\\+/ \u0026\u0026 $3\u003c'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"' \u0026\u0026 $7!=\"'\"$(which nologin)\"'\" \u0026\u0026 $7!=\"/bin/false\") {print}' /etc/passwd","type":"","test_info":["Run the commands appropriate for your distribution:\nSet the shell for any accounts returned by the audit to nologin:\n# usermod -s $(which nologin) \u003cuser\u003e\nLock any non root accounts returned by the audit:\n# usermod -L \u003cuser\u003e\nThe following command will set all system accounts to a non login shell:\nawk -F: '($1!=\"root\" \u0026\u0026 $1!=\"sync\" \u0026\u0026 $1!=\"shutdown\" \u0026\u0026 $1!=\"halt\" \u0026\u0026 $1!~/^\\+/ \u0026\u0026 $3\u003c'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"' \u0026\u0026 $7!=\"'\"$(which nologin)\"'\" \u0026\u0026 $7!=\"/bin/false\") {print $1}' /etc/passwd | while read user do usermod -s $(which nologin) $user done\nThe following command will automatically lock not root system accounts:\nawk -F: '($1!=\"root\" \u0026\u0026 $1!~/^\\+/ \u0026\u0026 $3\u003c'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!=\"L\" \u0026\u0026 $2!=\"LK\") {print $1}' | while read user do usermod -L $user done\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"5.4.2.b","test_desc":"Ensure system accounts are non-login","SubChecks":null,"audit_type":"","audit":"awk -F: '($1!=\"root\" \u0026\u0026 $1!~/^\\+/ \u0026\u0026 $3\u003c'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!=\"L\" \u0026\u0026 $2!=\"LK\") {print $1}'","type":"","test_info":["Run the commands appropriate for your distribution:\nSet the shell for any accounts returned by the audit to nologin:\n# usermod -s $(which nologin) \u003cuser\u003e\nLock any non root accounts returned by the audit:\n# usermod -L \u003cuser\u003e\nThe following command will set all system accounts to a non login shell:\nawk -F: '($1!=\"root\" \u0026\u0026 $1!=\"sync\" \u0026\u0026 $1!=\"shutdown\" \u0026\u0026 $1!=\"halt\" \u0026\u0026 $1!~/^\\+/ \u0026\u0026 $3\u003c'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"' \u0026\u0026 $7!=\"'\"$(which nologin)\"'\" \u0026\u0026 $7!=\"/bin/false\") {print $1}' /etc/passwd | while read user do usermod -s $(which nologin) $user done\nThe following command will automatically lock not root system accounts:\nawk -F: '($1!=\"root\" \u0026\u0026 $1!~/^\\+/ \u0026\u0026 $3\u003c'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!=\"L\" \u0026\u0026 $2!=\"LK\") {print $1}' | while read user do usermod -L $user done\n"],"status":"FAIL","actual_value":"passwd: You may not view or modify password information for messagebus.\npasswd: You may not view or modify password information for systemd-coredump.\npasswd: You may not view or modify password information for systemd-network.\npasswd: You may not view or modify password information for systemd-resolve.\npasswd: You may not view or modify password information for systemd-timesync.\npasswd: You may not view or modify password information for dhcpcd.\npasswd: You may not view or modify password information for systemd-oom.\npasswd: You may not view or modify password information for sshd.\npasswd: You may not view or modify password information for nscd.\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"5.4.3","test_desc":"Ensure default group for the root account is GID 0","SubChecks":null,"audit_type":"","audit":"grep ^root: /etc/passwd | cut -f4 -d:","type":"","test_info":["Run the following command to set the `root` user default group to GID `0` :\n\n# usermod -g 0 root\n"],"status":"PASS","actual_value":"0\n","expected_result":"'0' Is present","scored":true,"IsMultiple":false},{"test_number":"5.4.4.a","test_desc":"Ensure default user umask is 027 or more restrictive","SubChecks":[{"audit_type":"","audit":"grep umask /etc/bashrc","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"grep umask /etc/bash.bashrc","type":"","Constraints":{"platform":["ubuntu16","ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"5.4.4.b","test_desc":"Ensure default user umask is 027 or more restrictive","SubChecks":null,"audit_type":"","audit":"grep -h umask /etc/profile /etc/profile.d/*.sh","type":"","test_info":["Edit the `/etc/bashrc`, `/etc/profile` and `/etc/profile.d/*.sh` files (and the appropriate files for any other shell supported on your system) and add or edit any umask parameters as follows:\n\numask 027\n"],"status":"FAIL","actual_value":"grep: /etc/profile.d/*.sh: No such file or directory\n","expected_result":"'umask 027' Is present","scored":true,"IsMultiple":false,"reason":"grep: /etc/profile.d/*.sh: No such file or directory\n"},{"test_number":"5.4.5.a","test_desc":"Ensure default user shell timeout is 900 seconds or less","SubChecks":[{"audit_type":"","audit":"grep ^TMOUT /etc/bashrc","type":"","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"grep ^TMOUT /etc/bash.bashrc","type":"","Constraints":{"platform":["ubuntu16","ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"5.4.5.b","test_desc":"Ensure default user shell timeout is 900 seconds or less","SubChecks":null,"audit_type":"","audit":"grep ^TMOUT /etc/profile","type":"","test_info":["Edit the `/etc/bashrc` and `/etc/profile` files (and the appropriate files for any other shell supported on your system) and add or edit any umask parameters as follows:\n\nTMOUT=600\n"],"status":"FAIL","actual_value":"","expected_result":"Invalid Number(s) used for comparison: '' '900'","scored":true,"IsMultiple":false}],"pass":3,"fail":7,"warn":6,"info":0},{"section":"5.5","desc":"Set Shadow Password Suite Parameters","Constraints":null,"type":"","results":[{"test_number":"5.5","test_desc":"Ensure root login is restricted to system console","SubChecks":null,"audit_type":"","audit":"cat /etc/securetty","type":"manual","test_info":["Remove entries for any consoles that are not in a physically secure location.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"5.6.a","test_desc":"Ensure access to the su command is restricted","SubChecks":null,"audit_type":"","audit":"grep pam_wheel.so /etc/pam.d/su","type":"","test_info":["Add the following line to the `/etc/pam.d/su` file:\n\nauth required pam_wheel.so use_uid\n\nCreate a comma separated list of users in the wheel statement in the `/etc/group` file:\n\nwheel:x:10:root,\n"],"status":"FAIL","actual_value":"","expected_result":"'auth' Is present AND 'required' Is present AND 'pam_wheel.so' Is present AND 'use_uid' Is present","scored":true,"IsMultiple":false},{"test_number":"5.6.b","test_desc":"Ensure access to the su command is restricted","SubChecks":null,"audit_type":"","audit":"grep wheel /etc/group","type":"manual","test_info":["Add the following line to the `/etc/pam.d/su` file:\n\nauth required pam_wheel.so use_uid\n\nCreate a comma separated list of users in the wheel statement in the `/etc/group` file:\n\nwheel:x:10:root,\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"}],"pass":0,"fail":1,"warn":2,"info":0},{"section":"6","desc":"System Maintenance","Constraints":null,"type":"","results":null,"pass":0,"fail":0,"warn":0,"info":0},{"section":"6.1","desc":"System File Permissions","Constraints":null,"type":"","results":[{"test_number":"6.1.1","test_desc":"Audit system file permissions","SubChecks":[{"audit_type":"","audit":"rpm -Va --nomtime --nosize --nomd5 --nolinkto \u003e \u003cfilename\u003e","type":"manual","Constraints":{"platform":["rhel7"]}},{"audit_type":"","audit":"dpkg --verify \u003e \u003cfilename\u003e","type":"manual","Constraints":{"platform":["ubuntu16"]}},{"audit_type":"","audit":"apt-get source \u003e \u003cfilename\u003e","type":"manual","Constraints":{"platform":["ubuntu18"]}}],"audit_type":"","audit":null,"type":"","test_info":[""],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Failed to find a valid sub check, check your constraints "},{"test_number":"6.1.2","test_desc":"Ensure permissions on /etc/passwd are configured","SubChecks":null,"audit_type":"","audit":"stat -c %a/Uid:%U/%uGid:%G/%g /etc/passwd","type":"","test_info":["Run the following command to set permissions on `/etc/passwd` :\n\n# chown root:root /etc/passwd\n# chmod 644 /etc/passwd\n"],"status":"PASS","actual_value":"644/Uid:root/0Gid:root/0\n","expected_result":"'644/Uid:root/0Gid:root/0' Is present","scored":true,"IsMultiple":false},{"test_number":"6.1.3","test_desc":"Ensure permissions on /etc/shadow are configured","SubChecks":null,"audit_type":"","audit":"stat -c \"Uid:%U/%u Gid:%G permissions=%a\" /etc/shadow","type":"","test_info":["Run the one of the following chown commands as appropriate and the chmod to set permissions on `/etc/shadow` :\n\n# chown root:root /etc/shadow\n# chown root:shadow /etc/shadow\n# chmod o-rwx,g-wx /etc/shadow\n"],"status":"PASS","actual_value":"Uid:root/0 Gid:shadow permissions=640\n","expected_result":"'Uid:root/0' Is present AND 'Gid' matched by regex expression 'shadow|root' AND 'permissions' has permissions 640, expected 640 or more restrictive","scored":true,"IsMultiple":false},{"test_number":"6.1.4","test_desc":"Ensure permissions on /etc/group are configured","SubChecks":null,"audit_type":"","audit":"stat -c \"Uid:%U/%u Gid:%G/%g permissions=%a\" /etc/group","type":"","test_info":["Run the following command to set permissions on `/etc/group` :\n\n# chown root:root /etc/group\n# chmod 644 /etc/group\n"],"status":"PASS","actual_value":"Uid:root/0 Gid:root/0 permissions=644\n","expected_result":"'Uid:root/0 Gid:root/0 permissions=644' Is present","scored":true,"IsMultiple":false},{"test_number":"6.1.5","test_desc":"Ensure permissions on /etc/gshadow are configured","SubChecks":null,"audit_type":"","audit":"stat -c \"Uid:%U/%u Gid:%G permissions=%a\" /etc/gshadow","type":"","test_info":["Run the one of the following chown commands as appropriate and the chmod to set permissions on `/etc/gshadow` :\n\n# chown root:root /etc/gshadow\n# chown root:shadow /etc/gshadow\n# chmod o-rwx,g-rw /etc/gshadow\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/gshadow': No such file or directory\n","expected_result":"'Uid:root/0' Is present AND 'Gid' matched by regex expression 'shadow|root' AND 'permissions' has a non numeric value: ''","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/gshadow': No such file or directory\n"},{"test_number":"6.1.6","test_desc":"Ensure permissions on /etc/passwd- are configured","SubChecks":null,"audit_type":"","audit":"stat -c \"Uid:%U/%u Gid:%G/%g permissions=%a\" /etc/passwd-","type":"","test_info":["Run the following command to set permissions on `/etc/passwd-` :\n\n# chown root:root /etc/passwd-\n# chmod u-x,go-rwx /etc/passwd-\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/passwd-': No such file or directory\n","expected_result":"'Uid:root/0 Gid:root/0' Is present AND 'permissions' has a non numeric value: ''","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/passwd-': No such file or directory\n"},{"test_number":"6.1.7","test_desc":"Ensure permissions on /etc/shadow- are configured","SubChecks":null,"audit_type":"","audit":"stat -c \"Uid:%U/%u Gid:%G permissions=%a\" /etc/shadow-","type":"","test_info":["Run the one of the following chown commands as appropriate and the chmod to set permissions on `/etc/shadow-` :\n\n# chown root:root /etc/shadow-\n# chown root:shadow /etc/shadow-\n# chmod o-rwx,g-rw /etc/shadow-\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/shadow-': No such file or directory\n","expected_result":"'Uid:root/0' Is present AND 'Gid' matched by regex expression 'shadow|root' AND 'permissions' has a non numeric value: ''","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/shadow-': No such file or directory\n"},{"test_number":"6.1.8","test_desc":"Ensure permissions on /etc/group- are configured","SubChecks":null,"audit_type":"","audit":"stat -c \"Uid:%U/%u Gid:%G/%g permissions=%a\" /etc/group-","type":"","test_info":["Run the following command to set permissions on `/etc/group-` :\n\n# chown root:root /etc/group-\n# chmod u-x,go-wx /etc/group-\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/group-': No such file or directory\n","expected_result":"'Uid:root/0 Gid:root/0' Is present AND 'permissions' has a non numeric value: ''","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/group-': No such file or directory\n"},{"test_number":"6.1.9","test_desc":"Ensure permissions on /etc/gshadow- are configured","SubChecks":null,"audit_type":"","audit":"stat -c \"Uid:%U/%u Gid:%G permissions=%a\" /etc/gshadow-","type":"","test_info":["Run the one of the following chown commands as appropriate and the chmod to set permissions on `/etc/gshadow-` :\n\n# chown root:root /etc/gshadow-\n# chown root:shadow /etc/gshadow-\n# chmod o-rwx,g-rw /etc/gshadow-\n"],"status":"FAIL","actual_value":"stat: cannot statx '/etc/gshadow-': No such file or directory\n","expected_result":"'Uid:root/0' Is present AND 'Gid' matched by regex expression 'shadow|root' AND 'permissions' has a non numeric value: ''","scored":true,"IsMultiple":false,"reason":"stat: cannot statx '/etc/gshadow-': No such file or directory\n"},{"test_number":"6.1.10.a","test_desc":"Ensure no world writable files exist","SubChecks":null,"audit_type":"","audit":"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 | head -n 100","type":"","test_info":["Removing write access for the \"other\" category ( `chmod o-w ` ) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.\n"],"status":"FAIL","actual_value":"find: ‘/run/lock/lvm’: Permission denied\nfind: ‘/run/systemd/inaccessible/dir’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-udevd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-oomd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-timesyncd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-logind.service’: Permission denied\nfind: ‘/run/systemd/propagate/nscd.service’: Permission denied\nfind: ‘/run/lvm’: Permission denied\nfind: ‘/var/db/dhcpcd’: Permission denied\nfind: ‘/var/lib/NetworkManager-fortisslvpn’: Permission denied\nfind: ‘/var/lib/portables’: Permission denied\nfind: ‘/var/lib/private’: Permission denied\nfind: ‘/var/lib/machines’: Permission denied\nfind: ‘/var/log/private’: Permission denied\nfind: ‘/var/cache/private’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-timesyncd.service-VunPLh’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-logind.service-m8z5O2’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-oomd.service-9Py1Ug’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-nscd.service-0f5TAS’: Permission denied\nfind: ‘/root’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-logind.service-5kKcER’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-oomd.service-U0YvJd’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-timesyncd.service-ytXpdd’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-nscd.service-YajKJE’: Permission denied\nfind: ‘/lost+found’: Permission denied\nfind: ‘/etc/ipsec.d’: Permission denied\nfind: ‘/etc/NetworkManager/system-connections’: Permission denied\nfind: ‘/boot/lost+found’: Permission denied\nfind: ‘/boot/grub’: Permission denied\nfind: ‘/run/user/1000/systemd/inaccessible/dir’: Permission denied\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"6.1.10.b","test_desc":"Ensure no world writable files exist","SubChecks":null,"audit_type":"","audit":"find \u003cpartition\u003e -xdev -type f -perm -0002 ","type":"manual","test_info":["Removing write access for the \"other\" category ( `chmod o-w ` ) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"6.1.11.a","test_desc":"Ensure no unowned files or directories exist","SubChecks":null,"audit_type":"","audit":"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser | head -n 100","type":"","test_info":["Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.\n"],"status":"FAIL","actual_value":"find: ‘/run/lock/lvm’: Permission denied\nfind: ‘/run/systemd/inaccessible/dir’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-udevd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-oomd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-timesyncd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-logind.service’: Permission denied\nfind: ‘/run/systemd/propagate/nscd.service’: Permission denied\nfind: ‘/run/lvm’: Permission denied\nfind: ‘/var/db/dhcpcd’: Permission denied\nfind: ‘/var/lib/NetworkManager-fortisslvpn’: Permission denied\nfind: ‘/var/lib/portables’: Permission denied\nfind: ‘/var/lib/private’: Permission denied\nfind: ‘/var/lib/machines’: Permission denied\nfind: ‘/var/log/private’: Permission denied\nfind: ‘/var/cache/private’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-timesyncd.service-VunPLh’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-logind.service-m8z5O2’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-oomd.service-9Py1Ug’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-nscd.service-0f5TAS’: Permission denied\nfind: ‘/root’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-logind.service-5kKcER’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-oomd.service-U0YvJd’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-timesyncd.service-ytXpdd’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-nscd.service-YajKJE’: Permission denied\nfind: ‘/lost+found’: Permission denied\nfind: ‘/etc/ipsec.d’: Permission denied\nfind: ‘/etc/NetworkManager/system-connections’: Permission denied\nfind: ‘/boot/lost+found’: Permission denied\nfind: ‘/boot/grub’: Permission denied\nfind: ‘/run/user/1000/systemd/inaccessible/dir’: Permission denied\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"6.1.11.b","test_desc":"Ensure no unowned files or directories exist","SubChecks":null,"audit_type":"","audit":"find \u003cpartition\u003e -xdev -type f -perm -0002","type":"manual","test_info":["Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"6.1.12.a","test_desc":"Ensure no ungrouped files or directories exist","SubChecks":null,"audit_type":"","audit":"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nogroup | head -n 100","type":"","test_info":["Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.\n"],"status":"FAIL","actual_value":"find: ‘/run/lock/lvm’: Permission denied\nfind: ‘/run/systemd/inaccessible/dir’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-udevd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-oomd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-timesyncd.service’: Permission denied\nfind: ‘/run/systemd/propagate/systemd-logind.service’: Permission denied\nfind: ‘/run/systemd/propagate/nscd.service’: Permission denied\nfind: ‘/run/lvm’: Permission denied\nfind: ‘/var/db/dhcpcd’: Permission denied\nfind: ‘/var/lib/NetworkManager-fortisslvpn’: Permission denied\nfind: ‘/var/lib/portables’: Permission denied\nfind: ‘/var/lib/private’: Permission denied\nfind: ‘/var/lib/machines’: Permission denied\nfind: ‘/var/log/private’: Permission denied\nfind: ‘/var/cache/private’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-timesyncd.service-VunPLh’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-logind.service-m8z5O2’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-oomd.service-9Py1Ug’: Permission denied\nfind: ‘/var/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-nscd.service-0f5TAS’: Permission denied\nfind: ‘/root’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-logind.service-5kKcER’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-oomd.service-U0YvJd’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-systemd-timesyncd.service-ytXpdd’: Permission denied\nfind: ‘/tmp/systemd-private-1781aaf1fe5f4191af9e5870f33e9bb7-nscd.service-YajKJE’: Permission denied\nfind: ‘/lost+found’: Permission denied\nfind: ‘/etc/ipsec.d’: Permission denied\nfind: ‘/etc/NetworkManager/system-connections’: Permission denied\nfind: ‘/boot/lost+found’: Permission denied\nfind: ‘/boot/grub’: Permission denied\nfind: ‘/run/user/1000/systemd/inaccessible/dir’: Permission denied\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"6.1.12.b","test_desc":"Ensure no ungrouped files or directories exist","SubChecks":null,"audit_type":"","audit":"find \u003cpartition\u003e -xdev -nogroup","type":"manual","test_info":["Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":true,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"6.1.13.a","test_desc":"Audit SUID executables","SubChecks":null,"audit_type":"","audit":"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -4000 | head -n 100","type":"manual","test_info":["Ensure that no rogue SUID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"6.1.13.b","test_desc":"Audit SUID executables","SubChecks":null,"audit_type":"","audit":"find \u003cpartition\u003e -xdev -type f -perm -4000","type":"manual","test_info":["Ensure that no rogue SUID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"6.1.14.a","test_desc":"Audit SGID executables","SubChecks":null,"audit_type":"","audit":"df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -2000 | head -n 100","type":"manual","test_info":["Ensure that no rogue SGID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"},{"test_number":"6.1.14.b","test_desc":"Audit SGID executables","SubChecks":null,"audit_type":"","audit":"find \u003cpartition\u003e -xdev -type f -perm -2000","type":"manual","test_info":["Ensure that no rogue SGID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.\n"],"status":"WARN","actual_value":"","expected_result":"","scored":false,"IsMultiple":false,"reason":"Test marked as a manual test"}],"pass":3,"fail":8,"warn":8,"info":0},{"section":"6.2","desc":"User and Group Settings","Constraints":null,"type":"","results":[{"test_number":"6.2.1","test_desc":"Ensure password fields are not empty","SubChecks":null,"audit_type":"","audit":"awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}' /etc/shadow","type":"","test_info":["If any accounts in the /etc/shadow file do not have a password, run the following command\nto lock the account until it can be determined why it does not have a password:\n# passwd -l \u003cusername\u003e\nAlso, check to see if the account is logged in and investigate what it is being used for to\ndetermine if it needs to be forced off.\n"],"status":"FAIL","actual_value":"awk: fatal: cannot open file `/etc/shadow' for reading: Permission denied\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"awk: fatal: cannot open file `/etc/shadow' for reading: Permission denied\n"},{"test_number":"6.2.2","test_desc":"Ensure no legacy \"+\" entries exist in /etc/passwd","SubChecks":null,"audit_type":"","audit":"grep '^\\+:' /etc/passwd","type":"","test_info":["Remove any legacy '+' entries from `/etc/passwd` if they exist.\n"],"status":"FAIL","actual_value":"grep: warning: stray \\ before +\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: warning: stray \\ before +\n"},{"test_number":"6.2.3","test_desc":"Ensure no legacy \"+\" entries exist in /etc/shadow","SubChecks":null,"audit_type":"","audit":"grep '^\\+:' /etc/shadow","type":"","test_info":["Remove any legacy '+' entries from `/etc/shadow` if they exist.\n"],"status":"FAIL","actual_value":"grep: warning: stray \\ before +\ngrep: /etc/shadow: Permission denied\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: warning: stray \\ before +\ngrep: /etc/shadow: Permission denied\n"},{"test_number":"6.2.4","test_desc":"Ensure no legacy \"+\" entries exist in /etc/group","SubChecks":null,"audit_type":"","audit":"grep '^\\+:' /etc/group","type":"","test_info":["Remove any legacy '+' entries from `/etc/group` if they exist.\n"],"status":"FAIL","actual_value":"grep: warning: stray \\ before +\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false,"reason":"grep: warning: stray \\ before +\n"},{"test_number":"6.2.5","test_desc":"Ensure root is the only UID 0 account","SubChecks":null,"audit_type":"","audit":"awk -F: '($3 == 0) { print $1 }' /etc/passwd","type":"","test_info":["Remove any users other than `root` with UID `0` or assign them a new UID if appropriate.\n"],"status":"PASS","actual_value":"root\n","expected_result":"'root' Is present","scored":true,"IsMultiple":false},{"test_number":"6.2.6","test_desc":"Ensure root PATH Integrity","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\nif [ \"$(echo \"$PATH\" | grep ::)\" != \"\" ]; then\n        echo \"Empty Directory in PATH (::)\"\nfi\n\nif [ \"$(echo \"$PATH\" | grep :$)\" != \"\" ]; then\n        echo \"Trailing : in PATH\"\nfi\n\np=$(echo \"$PATH\" | sed -e 's/::/:/' -e 's/:$//' -e 's/:/ /g')\nset -- $p\nwhile [ \"$1\" != \"\" ]; do\n        if [ \"$1\" = \".\" ]; then\n                shift\n                continue\n        fi\n        if [ -d \"$1\" ]; then\n                dirperm=$(ls -ldH \"$1\" | cut -f1 -d\" \")\n                if [ \"$(echo \"$dirperm\" | cut -c6)\" != \"-\" ]; then\n                        echo \"Group Write permission set on directory $1\"\n                fi\n                if [ \"$(echo \"$dirperm\" | cut -c9)\" != \"-\" ]; then\n                        echo \"Other Write permission set on directory $1\"\n                fi\n                dirown=$(ls -ldH \"$1\" | awk '{print $3}')\n                if [ \"$dirown\" != \"root\" ] ; then\n                        echo \"$1 is not owned by root\"\n                fi\n        else\n                echo \"$1 is not a directory\"\n        fi\n        shift\ndone\n","type":"","test_info":["Correct or justify any items discovered in the Audit step.\n"],"status":"FAIL","actual_value":"/home/adrian/.nix-profile/bin is not a directory\n/nix/profile/bin is not a directory\n/home/adrian/.local/state/nix/profile/bin is not a directory\n/etc/profiles/per-user/adrian/bin is not a directory\n/nix/var/nix/profiles/default/bin is not a directory\n","expected_result":"'' is equal to ''","scored":true,"IsMultiple":false},{"test_number":"6.2.7","test_desc":"Ensure all users' home directories exist","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' |\n        while read -r user dir; do\n                if [ ! -d \"$dir\" ]; then\n                        echo \"The home directory ($dir) of user $user does not exist.\"\n                fi\n        done\n","type":"","test_info":["If any users' home directories do not exist, create them and make sure the respective user owns the directory. Users without an assigned home directory should be removed or assigned a home directory as appropriate.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.8","test_desc":"Ensure users' home directories permissions are 750 or more restrictive","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' |\nwhile read user dir; do\n    if [ ! -d \"$dir\" ]; then\n        echo \"The home directory ($dir) of user $user does not exist.\"\n    else\n        dirperm=$(ls -ld $dir | cut -f1 -d\" \")\n        if [ $(echo $dirperm | cut -c6) != \"-\" ]; then\n            echo \"Group Write permission set on the home directory ($dir) of user $user\"\n        fi\n        if [ $(echo $dirperm | cut -c8) != \"-\" ]; then\n            echo \"Other Read permission set on the home directory ($dir) of user $user\"\n        fi\n        if [ $(echo $dirperm | cut -c9) != \"-\" ]; then\n            echo \"Other Write permission set on the home directory ($dir) of user $user\"\n        fi\n        if [ $(echo $dirperm | cut -c10) != \"-\" ]; then\n            echo \"Other Execute permission set on the home directory ($dir) of user $user\"\n        fi\n    fi\ndone\n","type":"","test_info":["Making global modifications to user home directories without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file permissions and determine the action to be taken in accordance with site policy.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.9","test_desc":"Ensure users own their home directories","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do\n        if [ ! -d \"$dir\" ]; then\n                echo \"The home directory ($dir) of user $user does not exist.\"\n        else\n        owner=$(stat -L -c \"%U\" \"$dir\")\n                if [ \"$owner\" != \"$user\" ]; then\n                echo \"The home directory ($dir) of user $user is owned by $owner.\"\n                fi\n        fi\ndone\n","type":"","test_info":["Change the ownership of any home directories that are not owned by the defined user to the correct user.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.10","test_desc":"Ensure users' dot files are not group or world writable","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do\n        if [ ! -d \"$dir\" ]; then\n                echo \"The home directory ($dir) of user $user does not exist.\"\n        else\n                for file in $dir/.[A-Za-z0-9]*; do\n                        if [ ! -h \"$file\" -a -f \"$file\" ]; then\n                                fileperm=$(ls -ld $file | cut -f1 -d\" \")\n                                        if [ $(echo $fileperm | cut -c6) != \"-\" ]; then\n                                                echo \"Group Write permission set on file $file\"\n                                        fi\n                                        if [ $(echo $fileperm | cut -c9) != \"-\" ]; then\n                                                echo \"Other Write permission set on file $file\"\n                                fi\n                        fi\n                done\n        fi\ndone\n","type":"","test_info":["Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance with site policy.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.11","test_desc":"Ensure no users have .forward files","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do\n        if [ ! -d \"$dir\" ]; then\n                echo \"The home directory ($dir) of user $user does not exist.\"\n        else\n                if [ ! -h \"$dir/.forward\" -a -f \"$dir/.forward\" ]; then\n                        echo \".forward file $dir/.forward exists\"\n                fi\n        fi\ndone\n","type":"","test_info":["Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user `.forward` files and determine the action to be taken in accordance with site policy.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.12","test_desc":"Ensure no users have .netrc files","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do\n        if [ ! -d \"$dir\" ]; then\n                echo \"The home directory ($dir) of user $user does not exist.\"\n        else\n                if [ ! -h \"$dir/.netrc\" -a -f \"$dir/.netrc\" ]; then\n                        echo \".netrc file $dir/.netrc exists\"\n                fi\n        fi\ndone\n","type":"","test_info":["Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user `.netrc` files and determine the action to be taken in accordance with site policy.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.13","test_desc":"Ensure users' .netrc Files are not group or world accessible","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do\nif [ ! -d \"$dir\" ]; then\n        echo \"The home directory ($dir) of user $user does not exist.\"\nelse\n        for file in $dir/.netrc; do\n                if [ ! -h \"$file\" -a -f \"$file\" ]; then\n                        fileperm=$(ls -ld $file | cut -f1 -d\" \")\n                        if [ $(echo $fileperm | cut -c5) != \"-\" ]; then\n                                echo \"Group Read set on $file\"\n                        fi\n                        if [ $(echo $fileperm | cut -c6) != \"-\" ]; then\n                                echo \"Group Write set on $file\"\n                        fi\n                        if [ $(echo $fileperm | cut -c7) != \"-\" ]; then\n                                echo \"Group Execute set on $file\"\n                        fi\n                        if [ $(echo $fileperm | cut -c8) != \"-\" ]; then\n                                echo \"Other Read set on $file\"\n                        fi\n                        if [ $(echo $fileperm | cut -c9) != \"-\" ]; then\n                                echo \"Other Write set on $file\"\n                        fi\n                        if [ $(echo $fileperm | cut -c10) != \"-\" ]; then\n                                echo \"Other Execute set on $file\"\n                        fi\n                fi\n        done\nfi\ndone\n","type":"","test_info":["Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user `.netrc` file permissions and determine the action to be taken in accordance with site policy.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.14","test_desc":"Ensure no users have .rhosts files","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ngrep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 != \"'\"$(which nologin)\"'\" \u0026\u0026 $7 != \"/bin/false\") { print $1 \" \" $6 }' | while read user dir; do\nif [ ! -d \"$dir\" ]; then\n        echo \"The home directory ($dir) of user $user does not exist.\"\nelse\n        for file in $dir/.rhosts; do\n                if [ ! -h \"$file\" -a -f \"$file\" ]; then\n                        echo \".rhosts file in $dir\"\n                fi\n        done\nfi\ndone\n","type":"","test_info":["Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user `.rhosts` files and determine the action to be taken in accordance with site policy.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.15","test_desc":"Ensure all groups in /etc/passwd exist in /etc/group","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\nfor i in $(cut -s -d: -f4 /etc/passwd | sort -u ); do\n        grep -q -P \"^.*?:[^:]*:$i:\" /etc/group\n        if [ $? -ne 0 ]; then\n                echo \"Group $i is referenced by /etc/passwd but does not exist in /etc/group\"\n        fi\ndone\n","type":"","test_info":["Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.16","test_desc":"Ensure no duplicate UIDs exist","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ncut -f3 -d\":\" /etc/passwd | sort -n | uniq -c | while read x ; do\n        [ -z \"$x\" ] \u0026\u0026 break\n        set - $x\n        if [ $1 -gt 1 ]; then\n                users=$(awk -F: '($3 == n) { print $1 }' n=$2 /etc/passwd | xargs)\n                echo \"Duplicate UID ($2): $users\"\n        fi\n        done\n","type":"","test_info":["Based on the results of the audit script, establish unique UIDs and review all files owned by the shared UIDs to determine which UID they are supposed to belong to.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.17","test_desc":"Ensure no duplicate GIDs exist","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ncut -f3 -d\":\" /etc/group | sort -n | uniq -c | while read x ; do\n[ -z \"$x\" ] \u0026\u0026 break\nset - $x\nif [ $1 -gt 1 ]; then\n        groups=$(awk -F: '($3 == n) { print $1 }' n=$2 /etc/group | xargs)\n        echo \"Duplicate GID ($2): $groups\"\nfi\ndone\n","type":"","test_info":["Based on the results of the audit script, establish unique GIDs and review all files owned by the shared GID to determine which group they are supposed to belong to.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.18","test_desc":"Ensure no duplicate user names exist","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ncut -f1 -d\":\" /etc/passwd | sort -n | uniq -c | while read x ; do\n        [ -z \"$x\" ] \u0026\u0026 break\n        set - $x\n        if [ $1 -gt 1 ]; then\n                uids=$(awk -F: '($1 == n) { print $3 }' n=$2 /etc/passwd | xargs)\n                echo \"Duplicate User Name ($2): $uids\"\n        fi\n        done\n","type":"","test_info":["Based on the results of the audit script, establish unique user names for the users. File ownerships will automatically reflect the change as long as the users have unique UIDs.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.19","test_desc":"Ensure no duplicate group names exist","SubChecks":null,"audit_type":"","audit":"#!/bin/bash\ncut -f1 -d\":\" /etc/group | sort -n | uniq -c | while read x ; do\n        [ -z \"$x\" ] \u0026\u0026 break\n        set - $x\n        if [ $1 -gt 1 ]; then\n                gids=$(gawk -F: '($1 == n) { print $3 }' n=$2 /etc/group | xargs)\n                echo \"Duplicate Group Name ($2): $gids\"\n        fi\n        done\n","type":"","test_info":["Based on the results of the audit script, establish unique names for the user groups. File group ownerships will automatically reflect the change as long as the groups have unique GIDs.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.20.a","test_desc":"Ensure shadow group is empty","SubChecks":null,"audit_type":"","audit":"grep ^shadow:[^:]*:[^:]*:[^:]+ /etc/group","type":"","test_info":["Remove all users from the shadow group, and change the primary group of any users with shadow as their primary group.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false},{"test_number":"6.2.20.b","test_desc":"Ensure shadow group is empty","SubChecks":null,"audit_type":"","audit":"awk -F: '($4 == \"\") { print }' /etc/passwd","type":"","test_info":["Remove all users from the shadow group, and change the primary group of any users with shadow as their primary group.\n"],"status":"PASS","actual_value":"","expected_result":" '' has no output","scored":true,"IsMultiple":false}],"pass":16,"fail":5,"warn":0,"info":0}],"total_pass":83,"total_fail":161,"total_warn":109,"total_info":0,"DefinedConstraints":{"boot":["grub"],"platform":["nixos"],"syslog":["rsyslog"]}}
